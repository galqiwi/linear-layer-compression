

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                                         | 0/32 [00:00<?, ?it/s]
Starting ...
Ready.
0 self_attn.q_proj
Quantizing ...
time 0.72
error 1673622.0
0 self_attn.k_proj
Quantizing ...
time 0.27
error 1218731.5
0 self_attn.v_proj
Quantizing ...
time 0.27
error 829669.5625
0 self_attn.o_proj
Quantizing ...
time 0.27
error 17309.1796875
0 mlp.gate_proj
Quantizing ...
time 0.28
error 3690644.0
0 mlp.up_proj
Quantizing ...
time 0.28
error 3672645.0
0 mlp.down_proj
Quantizing ...
time 0.97

  3%|████████▌                                                                                                                                                                                                                                                                        | 1/32 [00:12<06:24, 12.41s/it]
1 self_attn.q_proj
Quantizing ...
time 0.71
error 6456443.0
1 self_attn.k_proj
Quantizing ...
time 0.27
error 6499552.0
1 self_attn.v_proj
Quantizing ...
time 0.27
error 6001164.0
1 self_attn.o_proj
Quantizing ...
time 0.27
error 141930.0
1 mlp.gate_proj
Quantizing ...
time 0.28
error 12488641.0
1 mlp.up_proj
Quantizing ...
time 0.28
error 12253280.0
1 mlp.down_proj
Quantizing ...
time 0.98

  6%|█████████████████                                                                                                                                                                                                                                                                | 2/32 [00:24<06:15, 12.50s/it]
2 self_attn.q_proj
Quantizing ...
time 0.76
error 23403028.0
2 self_attn.k_proj
Quantizing ...
time 0.28
error 23524300.0
2 self_attn.v_proj
Quantizing ...
time 0.27
error 22477792.0
2 self_attn.o_proj
Quantizing ...
time 0.27
error 167226.609375
2 mlp.gate_proj
Quantizing ...
time 0.28
error 28248384.0
2 mlp.up_proj
Quantizing ...
time 0.28
error 27930496.0
2 mlp.down_proj
Quantizing ...
time 0.98

  9%|█████████████████████████▌                                                                                                                                                                                                                                                       | 3/32 [00:37<06:09, 12.73s/it]
3 self_attn.q_proj
Quantizing ...
time 0.74
error 63998996.0
3 self_attn.k_proj
Quantizing ...
time 0.28
error 64299472.0
3 self_attn.v_proj
Quantizing ...
time 0.28
error 62248368.0
3 self_attn.o_proj
Quantizing ...
time 0.28
error 354181.46875
3 mlp.gate_proj
Quantizing ...
time 0.28
error 47543724.0
3 mlp.up_proj
Quantizing ...
time 0.28
error 47219960.0
3 mlp.down_proj
Quantizing ...
time 0.98

 12%|██████████████████████████████████▏                                                                                                                                                                                                                                              | 4/32 [00:51<06:02, 12.96s/it]
4 self_attn.q_proj
Quantizing ...
time 0.75
error 58655340.0
4 self_attn.k_proj
Quantizing ...
time 0.27
error 59025692.0
4 self_attn.v_proj
Quantizing ...
time 0.27
error 57086704.0
4 self_attn.o_proj
Quantizing ...
time 0.27
error 716048.25
4 mlp.gate_proj
Quantizing ...
time 0.28
error 65240256.0
4 mlp.up_proj
Quantizing ...
time 0.28
error 64742744.0
4 mlp.down_proj
Quantizing ...
time 0.98

 16%|██████████████████████████████████████████▋                                                                                                                                                                                                                                      | 5/32 [01:04<05:53, 13.10s/it]
5 self_attn.q_proj
Quantizing ...
time 0.77
error 65626084.0
5 self_attn.k_proj
Quantizing ...
time 0.28
error 65990312.0
5 self_attn.v_proj
Quantizing ...
time 0.28
error 64031788.0
5 self_attn.o_proj
Quantizing ...
time 0.28
error 1311204.0
5 mlp.gate_proj
Quantizing ...
time 0.28
error 79850640.0
5 mlp.up_proj
Quantizing ...
time 0.28
error 79132144.0
5 mlp.down_proj
Quantizing ...
time 0.99

 19%|███████████████████████████████████████████████████▏                                                                                                                                                                                                                             | 6/32 [01:18<05:44, 13.23s/it]
6 self_attn.q_proj
Quantizing ...
time 0.76
error 106295224.0
6 self_attn.k_proj
Quantizing ...
time 0.28
error 106370144.0
6 self_attn.v_proj
Quantizing ...
time 0.28
error 103321840.0
6 self_attn.o_proj
Quantizing ...
time 0.28
error 2542773.25
6 mlp.gate_proj
Quantizing ...
time 0.28
error 95811520.0
6 mlp.up_proj
Quantizing ...
time 0.28
error 94763096.0
6 mlp.down_proj
Quantizing ...
time 0.98

 22%|███████████████████████████████████████████████████████████▋                                                                                                                                                                                                                     | 7/32 [01:31<05:32, 13.30s/it]
7 self_attn.q_proj
Quantizing ...
time 0.76
error 116610160.0
7 self_attn.k_proj
Quantizing ...
time 0.28
error 116607440.0
7 self_attn.v_proj
Quantizing ...
time 0.28
error 113003872.0
7 self_attn.o_proj
Quantizing ...
time 0.27
error 3468198.5
7 mlp.gate_proj
Quantizing ...
time 0.28
error 111495648.0
7 mlp.up_proj
Quantizing ...
time 0.28
error 110348048.0
7 mlp.down_proj
Quantizing ...
time 0.99

 25%|████████████████████████████████████████████████████████████████████▎                                                                                                                                                                                                            | 8/32 [01:45<05:20, 13.36s/it]
8 self_attn.q_proj
Quantizing ...
time 0.76
error 114034112.0
8 self_attn.k_proj
Quantizing ...
time 0.28
error 114159312.0
8 self_attn.v_proj
Quantizing ...
time 0.28
error 111530576.0
8 self_attn.o_proj
Quantizing ...
time 0.28
error 5249728.0
8 mlp.gate_proj
Quantizing ...
time 0.28
error 120402496.0
8 mlp.up_proj
Quantizing ...
time 0.28
error 119328616.0
8 mlp.down_proj
Quantizing ...
time 0.98

 28%|████████████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                                    | 9/32 [01:58<05:08, 13.43s/it]
9 self_attn.q_proj
Quantizing ...
time 0.75
error 121770576.0
9 self_attn.k_proj
Quantizing ...
time 0.28
error 121942128.0
9 self_attn.v_proj
Quantizing ...
time 0.28
error 118896384.0
9 self_attn.o_proj
Quantizing ...
time 0.28
error 6855756.5
9 mlp.gate_proj
Quantizing ...
time 0.28
error 131376240.0
9 mlp.up_proj
Quantizing ...
time 0.28
error 130310256.0
9 mlp.down_proj
Quantizing ...
time 0.99

 31%|█████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                                           | 10/32 [02:12<04:55, 13.43s/it]
10 self_attn.q_proj
Quantizing ...
time 0.76
error 126596656.0
10 self_attn.k_proj
Quantizing ...
time 0.28
error 126927720.0
10 self_attn.v_proj
Quantizing ...
time 0.28
error 123639952.0
10 self_attn.o_proj
Quantizing ...
time 0.28
error 9540832.0
10 mlp.gate_proj
Quantizing ...
time 0.28
error 137584416.0
10 mlp.up_proj
Quantizing ...
time 0.28
error 136605040.0
10 mlp.down_proj
Quantizing ...
time 0.99

 34%|█████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                                  | 11/32 [02:25<04:42, 13.44s/it]
11 self_attn.q_proj
Quantizing ...
time 0.77
error 156162896.0
11 self_attn.k_proj
Quantizing ...
time 0.28
error 156950464.0
11 self_attn.v_proj
Quantizing ...
time 0.28
error 153538416.0
11 self_attn.o_proj
Quantizing ...
time 0.28
error 10049526.0
11 mlp.gate_proj
Quantizing ...
time 0.28
error 152398992.0
11 mlp.up_proj
Quantizing ...
time 0.28
error 151162528.0
11 mlp.down_proj
Quantizing ...
time 1.00

 38%|██████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                                          | 12/32 [02:39<04:29, 13.45s/it]
12 self_attn.q_proj
Quantizing ...
time 0.75
error 158348128.0
12 self_attn.k_proj
Quantizing ...
time 0.27
error 159326432.0
12 self_attn.v_proj
Quantizing ...
time 0.27
error 156127232.0
12 self_attn.o_proj
Quantizing ...
time 0.27
error 12008860.0
12 mlp.gate_proj
Quantizing ...
time 0.28
error 165703632.0
12 mlp.up_proj
Quantizing ...
time 0.28
error 164574208.0
12 mlp.down_proj
Quantizing ...
time 0.98

 41%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                                 | 13/32 [02:52<04:14, 13.42s/it]
13 self_attn.q_proj
Quantizing ...
time 0.75
error 165936304.0
13 self_attn.k_proj
Quantizing ...
time 0.28
error 166324752.0
13 self_attn.v_proj
Quantizing ...
time 0.28
error 162636352.0
13 self_attn.o_proj
Quantizing ...
time 0.28
error 11604657.0
13 mlp.gate_proj
Quantizing ...
time 0.28
error 177039712.0
13 mlp.up_proj
Quantizing ...
time 0.28
error 175850992.0
13 mlp.down_proj
Quantizing ...
time 0.99

 44%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                                         | 14/32 [03:05<04:01, 13.40s/it]
14 self_attn.q_proj
Quantizing ...
time 0.76
error 172506976.0
14 self_attn.k_proj
Quantizing ...
time 0.28
error 173680448.0
14 self_attn.v_proj
Quantizing ...
time 0.28
error 168906448.0
14 self_attn.o_proj
Quantizing ...
time 0.28
error 15022257.0
14 mlp.gate_proj
Quantizing ...
time 0.28
error 195661520.0
14 mlp.up_proj
Quantizing ...
time 0.28
error 194376448.0
14 mlp.down_proj
Quantizing ...
time 0.99

 47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                                                | 15/32 [03:19<03:47, 13.39s/it]
15 self_attn.q_proj
Quantizing ...
time 0.75
error 167835776.0
15 self_attn.k_proj
Quantizing ...
time 0.28
error 168921632.0
15 self_attn.v_proj
Quantizing ...
time 0.28
error 165197776.0
15 self_attn.o_proj
Quantizing ...
time 0.28
error 14899880.0
15 mlp.gate_proj
Quantizing ...
time 0.28
error 209937696.0
15 mlp.up_proj
Quantizing ...
time 0.28
error 208608768.0
15 mlp.down_proj
Quantizing ...
time 0.99

 50%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                        | 16/32 [03:32<03:33, 13.37s/it]
16 self_attn.q_proj
Quantizing ...
time 0.76
error 175278816.0
16 self_attn.k_proj
Quantizing ...
time 0.27
error 176477056.0
16 self_attn.v_proj
Quantizing ...
time 0.28
error 171789376.0
16 self_attn.o_proj
Quantizing ...
time 0.28
error 18209550.0
16 mlp.gate_proj
Quantizing ...
time 0.28
error 235509696.0
16 mlp.up_proj
Quantizing ...
time 0.28
error 234142144.0
16 mlp.down_proj
Quantizing ...
time 0.99

 53%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                               | 17/32 [03:45<03:20, 13.37s/it]
17 self_attn.q_proj
Quantizing ...
time 0.76
error 181226880.0
17 self_attn.k_proj
Quantizing ...
time 0.27
error 182128304.0
17 self_attn.v_proj
Quantizing ...
time 0.27
error 178349296.0
17 self_attn.o_proj
Quantizing ...
time 0.27
error 13413646.0
17 mlp.gate_proj
Quantizing ...
time 0.28
error 265303856.0
17 mlp.up_proj
Quantizing ...
time 0.28
error 263518496.0
17 mlp.down_proj
Quantizing ...
time 0.99

 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                       | 18/32 [03:59<03:07, 13.37s/it]
18 self_attn.q_proj
Quantizing ...
time 0.76
error 202203472.0
18 self_attn.k_proj
Quantizing ...
time 0.27
error 202717248.0
18 self_attn.v_proj
Quantizing ...
time 0.27
error 198848192.0
18 self_attn.o_proj
Quantizing ...
time 0.28
error 13811454.0
18 mlp.gate_proj
Quantizing ...
time 0.28
error 292886592.0
18 mlp.up_proj
Quantizing ...
time 0.28
error 291066624.0
18 mlp.down_proj
Quantizing ...
time 0.99

 59%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                              | 19/32 [04:12<02:53, 13.37s/it]
19 self_attn.q_proj
Quantizing ...
time 0.76
error 197383248.0
19 self_attn.k_proj
Quantizing ...
time 0.27
error 198591616.0
19 self_attn.v_proj
Quantizing ...
time 0.28
error 194949184.0
19 self_attn.o_proj
Quantizing ...
time 0.27
error 12875469.0
19 mlp.gate_proj
Quantizing ...
time 0.28
error 310476800.0
19 mlp.up_proj
Quantizing ...
time 0.28
error 308839360.0
19 mlp.down_proj
Quantizing ...
time 0.99

 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                      | 20/32 [04:25<02:40, 13.36s/it]
20 self_attn.q_proj
Quantizing ...
time 0.77
error 199186144.0
20 self_attn.k_proj
Quantizing ...
time 0.28
error 199812864.0
20 self_attn.v_proj
Quantizing ...
time 0.27
error 195441584.0
20 self_attn.o_proj
Quantizing ...
time 0.27
error 15166409.0
20 mlp.gate_proj
Quantizing ...
time 0.28
error 322894944.0
20 mlp.up_proj
Quantizing ...
time 0.28
error 321129888.0
20 mlp.down_proj
Quantizing ...
time 0.99

 66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                             | 21/32 [04:39<02:27, 13.38s/it]
21 self_attn.q_proj
Quantizing ...
time 0.75
error 216680080.0
21 self_attn.k_proj
Quantizing ...
time 0.27
error 217431904.0
21 self_attn.v_proj
Quantizing ...
time 0.27
error 213113088.0
21 self_attn.o_proj
Quantizing ...
time 0.27
error 13713593.0
21 mlp.gate_proj
Quantizing ...
time 0.28
error 340765376.0
21 mlp.up_proj
Quantizing ...
time 0.28
error 338884736.0
21 mlp.down_proj
Quantizing ...
time 0.98

 69%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                     | 22/32 [04:52<02:13, 13.36s/it]
22 self_attn.q_proj
Quantizing ...
time 0.75
error 222508992.0
22 self_attn.k_proj
Quantizing ...
time 0.28
error 223021872.0
22 self_attn.v_proj
Quantizing ...
time 0.27
error 219400768.0
22 self_attn.o_proj
Quantizing ...
time 0.27
error 16901738.0
22 mlp.gate_proj
Quantizing ...
time 0.28
error 349348000.0
22 mlp.up_proj
Quantizing ...
time 0.29
error 347625856.0
22 mlp.down_proj
Quantizing ...
time 0.98

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                            | 23/32 [05:05<02:00, 13.36s/it]
23 self_attn.q_proj
Quantizing ...
time 0.76
error 240757856.0
23 self_attn.k_proj
Quantizing ...
time 0.27
error 241293792.0
23 self_attn.v_proj
Quantizing ...
time 0.28
error 238558736.0
23 self_attn.o_proj
Quantizing ...
time 0.27
error 13900302.0
23 mlp.gate_proj
Quantizing ...
time 0.28
error 370799392.0
23 mlp.up_proj
Quantizing ...
time 0.28
error 368986176.0
23 mlp.down_proj
Quantizing ...
time 0.98

 75%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                    | 24/32 [05:19<01:46, 13.37s/it]
24 self_attn.q_proj
Quantizing ...
time 0.76
error 235316064.0
24 self_attn.k_proj
Quantizing ...
time 0.28
error 236309600.0
24 self_attn.v_proj
Quantizing ...
time 0.28
error 232339184.0
24 self_attn.o_proj
Quantizing ...
time 0.28
error 17420836.0
24 mlp.gate_proj
Quantizing ...
time 0.28
error 381439168.0
24 mlp.up_proj
Quantizing ...
time 0.28
error 379876672.0
24 mlp.down_proj
Quantizing ...
time 0.99

 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                           | 25/32 [05:32<01:33, 13.39s/it]
25 self_attn.q_proj
Quantizing ...
time 0.75
error 264039248.0
25 self_attn.k_proj
Quantizing ...
time 0.28
error 264294976.0
25 self_attn.v_proj
Quantizing ...
time 0.28
error 261330912.0
25 self_attn.o_proj
Quantizing ...
time 0.27
error 11819937.0
25 mlp.gate_proj
Quantizing ...
time 0.28
error 406333824.0
25 mlp.up_proj
Quantizing ...
time 0.28
error 404694336.0
25 mlp.down_proj
Quantizing ...
time 0.99

 81%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                   | 26/32 [05:46<01:20, 13.39s/it]
26 self_attn.q_proj
Quantizing ...
time 0.76
error 256038464.0
26 self_attn.k_proj
Quantizing ...
time 0.28
error 256754176.0
26 self_attn.v_proj
Quantizing ...
time 0.27
error 252999648.0
26 self_attn.o_proj
Quantizing ...
time 0.28
error 19432650.0
26 mlp.gate_proj
Quantizing ...
time 0.28
error 418670144.0
26 mlp.up_proj
Quantizing ...
time 0.28
error 417206752.0
26 mlp.down_proj
Quantizing ...
time 0.98

 84%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                          | 27/32 [05:59<01:06, 13.38s/it]
27 self_attn.q_proj
Quantizing ...
time 0.75
error 254174112.0
27 self_attn.k_proj
Quantizing ...
time 0.27
error 254270320.0
27 self_attn.v_proj
Quantizing ...
time 0.28
error 251742944.0
27 self_attn.o_proj
Quantizing ...
time 0.28
error 12762810.0
27 mlp.gate_proj
Quantizing ...
time 0.28
error 439682784.0
27 mlp.up_proj
Quantizing ...
time 0.28
error 438414496.0
27 mlp.down_proj
Quantizing ...
time 0.98

 88%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                  | 28/32 [06:12<00:53, 13.38s/it]
28 self_attn.q_proj
Quantizing ...
time 0.78
error 262349344.0
28 self_attn.k_proj
Quantizing ...
time 0.28
error 262784288.0
28 self_attn.v_proj
Quantizing ...
time 0.27
error 259439328.0
28 self_attn.o_proj
Quantizing ...
time 0.27
error 15914789.0
28 mlp.gate_proj
Quantizing ...
time 0.28
error 457361120.0
28 mlp.up_proj
Quantizing ...
time 0.28
error 456280512.0
28 mlp.down_proj
Quantizing ...
time 0.98

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                         | 29/32 [06:26<00:40, 13.41s/it]
29 self_attn.q_proj
Quantizing ...
time 0.76
error 240925056.0
29 self_attn.k_proj
Quantizing ...
time 0.28
error 242326656.0
29 self_attn.v_proj
Quantizing ...
time 0.28
error 238277376.0
29 self_attn.o_proj
Quantizing ...
time 0.27
error 15484741.0
29 mlp.gate_proj
Quantizing ...
time 0.28
error 461878400.0
29 mlp.up_proj
Quantizing ...
time 0.28
error 461194688.0
29 mlp.down_proj
Quantizing ...
time 0.98

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                 | 30/32 [06:39<00:26, 13.40s/it]
30 self_attn.q_proj
Quantizing ...
time 0.75
error 249437744.0
30 self_attn.k_proj
Quantizing ...
time 0.28
error 250075184.0
30 self_attn.v_proj
Quantizing ...
time 0.27
error 246658080.0
30 self_attn.o_proj
Quantizing ...
time 0.27
error 15384554.0
30 mlp.gate_proj
Quantizing ...
time 0.28
error 452195136.0
30 mlp.up_proj
Quantizing ...
time 0.28
error 452049824.0
30 mlp.down_proj
Quantizing ...
time 0.98

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌        | 31/32 [06:53<00:13, 13.40s/it]
31 self_attn.q_proj
Quantizing ...
time 0.75
error 165858016.0
31 self_attn.k_proj
Quantizing ...
time 0.28
error 166622368.0
31 self_attn.v_proj
Quantizing ...
time 0.27
error 163487936.0
31 self_attn.o_proj
Quantizing ...
time 0.27
error 24271842.0
31 mlp.gate_proj
Quantizing ...
time 0.28
error 352438816.0
31 mlp.up_proj
Quantizing ...
time 0.28
error 352081664.0
31 mlp.down_proj
Quantizing ...
time 0.99

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 32/32 [07:06<00:00, 13.33s/it]
427.1224777698517
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
8.006224632263184