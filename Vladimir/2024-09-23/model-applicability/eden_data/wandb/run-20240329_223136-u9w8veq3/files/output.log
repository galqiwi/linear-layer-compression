

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Starting ...
Ready.
  0%|                                                                                                                                                                                                     | 0/32 [00:00<?, ?it/s]
0 self_attn.q_proj
Quantizing ...
time 0.96
error 65194.9453125
0 self_attn.k_proj
Quantizing ...
time 0.52
error 65669.421875
0 self_attn.v_proj
Quantizing ...
time 0.52
error 65763.421875
0 self_attn.o_proj
Quantizing ...
time 0.52
error 1216.198974609375
0 mlp.gate_proj
Quantizing ...
time 0.53
error 273304.5
0 mlp.up_proj
Quantizing ...
time 0.53
error 273397.875
0 mlp.down_proj
Quantizing ...
time 1.65

  3%|█████▉                                                                                                                                                                                       | 1/32 [00:14<07:27, 14.44s/it]
1 self_attn.q_proj
Quantizing ...
time 0.94
error 477157.75
1 self_attn.k_proj
Quantizing ...
time 0.53
error 477006.6875
1 self_attn.v_proj
Quantizing ...
time 0.53
error 475599.53125
1 self_attn.o_proj
Quantizing ...
time 0.53
error 9643.19921875
1 mlp.gate_proj
Quantizing ...
time 0.53
error 913107.25
1 mlp.up_proj
Quantizing ...
time 0.53
error 912823.625
1 mlp.down_proj
Quantizing ...
time 1.65

  6%|███████████▊                                                                                                                                                                                 | 2/32 [00:28<07:13, 14.44s/it]
2 self_attn.q_proj
Quantizing ...
time 0.94
error 1766785.625
2 self_attn.k_proj
Quantizing ...
time 0.52
error 1769570.375
2 self_attn.v_proj
Quantizing ...
time 0.52
error 1764697.0
2 self_attn.o_proj
Quantizing ...
time 0.52
error 18976.6484375
2 mlp.gate_proj
Quantizing ...
time 0.53
error 2191727.75
2 mlp.up_proj
Quantizing ...
time 0.52
error 2189883.0
2 mlp.down_proj
Quantizing ...
time 1.64

  9%|█████████████████▋                                                                                                                                                                           | 3/32 [00:43<06:59, 14.45s/it]
3 self_attn.q_proj
Quantizing ...
time 0.96
error 5225628.0
3 self_attn.k_proj
Quantizing ...
time 0.52
error 5230975.0
3 self_attn.v_proj
Quantizing ...
time 0.52
error 5222748.0
3 self_attn.o_proj
Quantizing ...
time 0.52
error 39070.90625
3 mlp.gate_proj
Quantizing ...
time 0.53
error 3951567.0
3 mlp.up_proj
Quantizing ...
time 0.53
error 3949290.5
3 mlp.down_proj
Quantizing ...
time 1.68

 12%|███████████████████████▋                                                                                                                                                                     | 4/32 [00:58<06:47, 14.54s/it]
4 self_attn.q_proj
Quantizing ...
time 1.00
error 4805504.0
4 self_attn.k_proj
Quantizing ...
time 0.53
error 4813372.0
4 self_attn.v_proj
Quantizing ...
time 0.52
error 4798787.0
4 self_attn.o_proj
Quantizing ...
time 0.53
error 72907.1953125
4 mlp.gate_proj
Quantizing ...
time 0.53
error 5439981.0
4 mlp.up_proj
Quantizing ...
time 0.53
error 5442359.5
4 mlp.down_proj
Quantizing ...
time 1.66

 16%|█████████████████████████████▌                                                                                                                                                               | 5/32 [01:12<06:35, 14.67s/it]
5 self_attn.q_proj
Quantizing ...
time 1.00
error 5477726.5
5 self_attn.k_proj
Quantizing ...
time 0.52
error 5474894.5
5 self_attn.v_proj
Quantizing ...
time 0.53
error 5467333.0
5 self_attn.o_proj
Quantizing ...
time 0.52
error 117641.4140625
5 mlp.gate_proj
Quantizing ...
time 0.53
error 6861830.5
5 mlp.up_proj
Quantizing ...
time 0.53
error 6859470.0
5 mlp.down_proj
Quantizing ...
time 1.65

 19%|███████████████████████████████████▍                                                                                                                                                         | 6/32 [01:27<06:23, 14.75s/it]
6 self_attn.q_proj
Quantizing ...
time 0.98
error 8855003.0
6 self_attn.k_proj
Quantizing ...
time 0.52
error 8863734.0
6 self_attn.v_proj
Quantizing ...
time 0.52
error 8850268.0
6 self_attn.o_proj
Quantizing ...
time 0.52
error 182849.59375
6 mlp.gate_proj
Quantizing ...
time 0.53
error 8472686.0
6 mlp.up_proj
Quantizing ...
time 0.53
error 8463506.0
6 mlp.down_proj
Quantizing ...
time 1.67

 22%|█████████████████████████████████████████▎                                                                                                                                                   | 7/32 [01:42<06:10, 14.82s/it]
7 self_attn.q_proj
Quantizing ...
time 0.98
error 9738893.0
7 self_attn.k_proj
Quantizing ...
time 0.52
error 9733494.0
7 self_attn.v_proj
Quantizing ...
time 0.52
error 9712844.0
7 self_attn.o_proj
Quantizing ...
time 0.52
error 254835.0625
7 mlp.gate_proj
Quantizing ...
time 0.53
error 9811896.0
7 mlp.up_proj
Quantizing ...
time 0.53
error 9803542.0
7 mlp.down_proj
Quantizing ...
time 1.66

 25%|███████████████████████████████████████████████▎                                                                                                                                             | 8/32 [01:57<05:57, 14.89s/it]
8 self_attn.q_proj
Quantizing ...
time 0.98
error 9522098.0
8 self_attn.k_proj
Quantizing ...
time 0.52
error 9521906.0
8 self_attn.v_proj
Quantizing ...
time 0.52
error 9510254.0
8 self_attn.o_proj
Quantizing ...
time 0.52
error 387083.21875
8 mlp.gate_proj
Quantizing ...
time 0.53
error 10527793.0
8 mlp.up_proj
Quantizing ...
time 0.53
error 10522204.0
8 mlp.down_proj
Quantizing ...
time 1.67

 28%|█████████████████████████████████████████████████████▏                                                                                                                                       | 9/32 [02:12<05:43, 14.92s/it]
9 self_attn.q_proj
Quantizing ...
time 1.00
error 10036864.0
9 self_attn.k_proj
Quantizing ...
time 0.52
error 10041224.0
9 self_attn.v_proj
Quantizing ...
time 0.52
error 10019763.0
9 self_attn.o_proj
Quantizing ...
time 0.52
error 505742.8125
9 mlp.gate_proj
Quantizing ...
time 0.53
error 11365222.0
9 mlp.up_proj
Quantizing ...
time 0.53
error 11366171.0
9 mlp.down_proj
Quantizing ...
time 1.67

 31%|██████████████████████████████████████████████████████████▊                                                                                                                                 | 10/32 [02:27<05:29, 14.96s/it]
10 self_attn.q_proj
Quantizing ...
time 0.99
error 10406757.0
10 self_attn.k_proj
Quantizing ...
time 0.52
error 10407258.0
10 self_attn.v_proj
Quantizing ...
time 0.52
error 10391780.0
10 self_attn.o_proj
Quantizing ...
time 0.53
error 715613.5
10 mlp.gate_proj
Quantizing ...
time 0.53
error 11902434.0
10 mlp.up_proj
Quantizing ...
time 0.53
error 11887706.0
10 mlp.down_proj
Quantizing ...
time 1.66

 34%|████████████████████████████████████████████████████████████████▋                                                                                                                           | 11/32 [02:42<05:14, 14.95s/it]
11 self_attn.q_proj
Quantizing ...
time 0.99
error 12766234.0
11 self_attn.k_proj
Quantizing ...
time 0.53
error 12762263.0
11 self_attn.v_proj
Quantizing ...
time 0.52
error 12735662.0
11 self_attn.o_proj
Quantizing ...
time 0.52
error 693802.625
11 mlp.gate_proj
Quantizing ...
time 0.53
error 12977928.0
11 mlp.up_proj
Quantizing ...
time 0.53
error 12967397.0
11 mlp.down_proj
Quantizing ...
time 1.67

 38%|██████████████████████████████████████████████████████████████████████▌                                                                                                                     | 12/32 [02:57<04:59, 14.96s/it]
12 self_attn.q_proj
Quantizing ...
time 1.02
error 12914092.0
12 self_attn.k_proj
Quantizing ...
time 0.53
error 12930430.0
12 self_attn.v_proj
Quantizing ...
time 0.53
error 12917566.0
12 self_attn.o_proj
Quantizing ...
time 0.53
error 812903.5625
12 mlp.gate_proj
Quantizing ...
time 0.53
error 13919616.0
12 mlp.up_proj
Quantizing ...
time 0.53
error 13917322.0
12 mlp.down_proj
Quantizing ...
time 1.67

 41%|████████████████████████████████████████████████████████████████████████████▍                                                                                                               | 13/32 [03:12<04:44, 14.97s/it]
13 self_attn.q_proj
Quantizing ...
time 0.99
error 13460646.0
13 self_attn.k_proj
Quantizing ...
time 0.53
error 13463514.0
13 self_attn.v_proj
Quantizing ...
time 0.53
error 13430557.0
13 self_attn.o_proj
Quantizing ...
time 0.53
error 844816.625
13 mlp.gate_proj
Quantizing ...
time 0.53
error 14712192.0
13 mlp.up_proj
Quantizing ...
time 0.53
error 14708000.0
13 mlp.down_proj
Quantizing ...
time 1.66

 44%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                         | 14/32 [03:27<04:29, 14.98s/it]
14 self_attn.q_proj
Quantizing ...
time 0.98
error 13918456.0
14 self_attn.k_proj
Quantizing ...
time 0.52
error 13927308.0
14 self_attn.v_proj
Quantizing ...
time 0.52
error 13902456.0
14 self_attn.o_proj
Quantizing ...
time 0.52
error 1042900.9375
14 mlp.gate_proj
Quantizing ...
time 0.53
error 16209806.0
14 mlp.up_proj
Quantizing ...
time 0.53
error 16210798.0
14 mlp.down_proj
Quantizing ...
time 1.66

 47%|████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 15/32 [03:42<04:14, 14.97s/it]
15 self_attn.q_proj
Quantizing ...
time 1.00
error 13552434.0
15 self_attn.k_proj
Quantizing ...
time 0.52
error 13564362.0
15 self_attn.v_proj
Quantizing ...
time 0.52
error 13537151.0
15 self_attn.o_proj
Quantizing ...
time 0.53
error 1078726.5
15 mlp.gate_proj
Quantizing ...
time 0.53
error 17464400.0
15 mlp.up_proj
Quantizing ...
time 0.53
error 17449172.0
15 mlp.down_proj
Quantizing ...
time 1.67

 50%|██████████████████████████████████████████████████████████████████████████████████████████████                                                                                              | 16/32 [03:57<03:59, 14.99s/it]
16 self_attn.q_proj
Quantizing ...
time 0.98
error 14259206.0
16 self_attn.k_proj
Quantizing ...
time 0.52
error 14268050.0
16 self_attn.v_proj
Quantizing ...
time 0.52
error 14242646.0
16 self_attn.o_proj
Quantizing ...
time 0.52
error 1311502.0
16 mlp.gate_proj
Quantizing ...
time 0.53
error 19591802.0
16 mlp.up_proj
Quantizing ...
time 0.53
error 19587096.0
16 mlp.down_proj
Quantizing ...
time 1.65

 53%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                        | 17/32 [04:12<03:44, 14.96s/it]
17 self_attn.q_proj
Quantizing ...
time 0.99
error 15054644.0
17 self_attn.k_proj
Quantizing ...
time 0.52
error 15052052.0
17 self_attn.v_proj
Quantizing ...
time 0.52
error 15036829.0
17 self_attn.o_proj
Quantizing ...
time 0.52
error 984908.125
17 mlp.gate_proj
Quantizing ...
time 0.53
error 22428208.0
17 mlp.up_proj
Quantizing ...
time 0.53
error 22396988.0
17 mlp.down_proj
Quantizing ...
time 1.66

 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                  | 18/32 [04:27<03:29, 14.96s/it]
18 self_attn.q_proj
Quantizing ...
time 0.96
error 17027522.0
18 self_attn.k_proj
Quantizing ...
time 0.52
error 17011634.0
18 self_attn.v_proj
Quantizing ...
time 0.52
error 17004144.0
18 self_attn.o_proj
Quantizing ...
time 0.53
error 1054357.125
18 mlp.gate_proj
Quantizing ...
time 0.53
error 25183916.0
18 mlp.up_proj
Quantizing ...
time 0.53
error 25159200.0
18 mlp.down_proj
Quantizing ...
time 1.66

 59%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                            | 19/32 [04:42<03:14, 14.97s/it]
19 self_attn.q_proj
Quantizing ...
time 0.99
error 16880900.0
19 self_attn.k_proj
Quantizing ...
time 0.52
error 16870770.0
19 self_attn.v_proj
Quantizing ...
time 0.52
error 16878608.0
19 self_attn.o_proj
Quantizing ...
time 0.52
error 969004.5625
19 mlp.gate_proj
Quantizing ...
time 0.53
error 27120830.0
19 mlp.up_proj
Quantizing ...
time 0.53
error 27118620.0
19 mlp.down_proj
Quantizing ...
time 1.66

 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                      | 20/32 [04:57<02:59, 14.98s/it]
20 self_attn.q_proj
Quantizing ...
time 0.98
error 17151986.0
20 self_attn.k_proj
Quantizing ...
time 0.52
error 17135348.0
20 self_attn.v_proj
Quantizing ...
time 0.52
error 17111624.0
20 self_attn.o_proj
Quantizing ...
time 0.52
error 1037302.375
20 mlp.gate_proj
Quantizing ...
time 0.53
error 28628160.0
20 mlp.up_proj
Quantizing ...
time 0.53
error 28616168.0
20 mlp.down_proj
Quantizing ...
time 1.67

 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                | 21/32 [05:12<02:44, 14.96s/it]
21 self_attn.q_proj
Quantizing ...
time 0.99
error 19056560.0
21 self_attn.k_proj
Quantizing ...
time 0.52
error 19073190.0
21 self_attn.v_proj
Quantizing ...
time 0.52
error 19032732.0
21 self_attn.o_proj
Quantizing ...
time 0.52
error 958982.0625
21 mlp.gate_proj
Quantizing ...
time 0.53
error 30648784.0
21 mlp.up_proj
Quantizing ...
time 0.53
error 30627648.0
21 mlp.down_proj
Quantizing ...
time 1.67

 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 22/32 [05:27<02:29, 14.95s/it]
22 self_attn.q_proj
Quantizing ...
time 0.98
error 19664688.0
22 self_attn.k_proj
Quantizing ...
time 0.52
error 19668132.0
22 self_attn.v_proj
Quantizing ...
time 0.52
error 19635614.0
22 self_attn.o_proj
Quantizing ...
time 0.52
error 1135465.25
22 mlp.gate_proj
Quantizing ...
time 0.53
error 32341458.0
22 mlp.up_proj
Quantizing ...
time 0.53
error 32331008.0
22 mlp.down_proj
Quantizing ...
time 1.68

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 23/32 [05:42<02:14, 14.95s/it]
23 self_attn.q_proj
Quantizing ...
time 0.98
error 21994900.0
23 self_attn.k_proj
Quantizing ...
time 0.52
error 21979804.0
23 self_attn.v_proj
Quantizing ...
time 0.53
error 21964572.0
23 self_attn.o_proj
Quantizing ...
time 0.52
error 1085431.75
23 mlp.gate_proj
Quantizing ...
time 0.53
error 34653928.0
23 mlp.up_proj
Quantizing ...
time 0.53
error 34618608.0
23 mlp.down_proj
Quantizing ...
time 1.68

 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                               | 24/32 [05:57<01:59, 14.94s/it]
24 self_attn.q_proj
Quantizing ...
time 0.97
error 21551212.0
24 self_attn.k_proj
Quantizing ...
time 0.52
error 21555264.0
24 self_attn.v_proj
Quantizing ...
time 0.52
error 21537278.0
24 self_attn.o_proj
Quantizing ...
time 0.52
error 1207316.25
24 mlp.gate_proj
Quantizing ...
time 0.53
error 36457084.0
24 mlp.up_proj
Quantizing ...
time 0.53
error 36473824.0
24 mlp.down_proj
Quantizing ...
time 1.66

 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 25/32 [06:12<01:44, 14.92s/it]
25 self_attn.q_proj
Quantizing ...
time 0.97
error 24931364.0
25 self_attn.k_proj
Quantizing ...
time 0.52
error 24944532.0
25 self_attn.v_proj
Quantizing ...
time 0.52
error 24924384.0
25 self_attn.o_proj
Quantizing ...
time 0.53
error 907146.75
25 mlp.gate_proj
Quantizing ...
time 0.53
error 38974648.0
25 mlp.up_proj
Quantizing ...
time 0.53
error 38959264.0
25 mlp.down_proj
Quantizing ...
time 1.67

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 26/32 [06:27<01:29, 14.90s/it]
26 self_attn.q_proj
Quantizing ...
time 0.98
error 23913184.0
26 self_attn.k_proj
Quantizing ...
time 0.53
error 23887636.0
26 self_attn.v_proj
Quantizing ...
time 0.53
error 23908174.0
26 self_attn.o_proj
Quantizing ...
time 0.53
error 1389687.5
26 mlp.gate_proj
Quantizing ...
time 0.53
error 41019140.0
26 mlp.up_proj
Quantizing ...
time 0.53
error 41013724.0
26 mlp.down_proj
Quantizing ...
time 1.66

 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 27/32 [06:41<01:14, 14.89s/it]
27 self_attn.q_proj
Quantizing ...
time 0.99
error 24593288.0
27 self_attn.k_proj
Quantizing ...
time 0.52
error 24574462.0
27 self_attn.v_proj
Quantizing ...
time 0.52
error 24582740.0
27 self_attn.o_proj
Quantizing ...
time 0.52
error 1290350.0
27 mlp.gate_proj
Quantizing ...
time 0.53
error 43496736.0
27 mlp.up_proj
Quantizing ...
time 0.53
error 43469500.0
27 mlp.down_proj
Quantizing ...
time 1.66

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 28/32 [06:56<00:59, 14.88s/it]
28 self_attn.q_proj
Quantizing ...
time 1.00
error 25363038.0
28 self_attn.k_proj
Quantizing ...
time 0.52
error 25361302.0
28 self_attn.v_proj
Quantizing ...
time 0.52
error 25369584.0
28 self_attn.o_proj
Quantizing ...
time 0.52
error 1428263.375
28 mlp.gate_proj
Quantizing ...
time 0.53
error 45361016.0
28 mlp.up_proj
Quantizing ...
time 0.53
error 45386852.0
28 mlp.down_proj
Quantizing ...
time 1.65

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 29/32 [07:11<00:44, 14.88s/it]
29 self_attn.q_proj
Quantizing ...
time 0.98
error 23451834.0
29 self_attn.k_proj
Quantizing ...
time 0.52
error 23473924.0
29 self_attn.v_proj
Quantizing ...
time 0.52
error 23465542.0
29 self_attn.o_proj
Quantizing ...
time 0.53
error 1368320.75
29 mlp.gate_proj
Quantizing ...
time 0.53
error 46594328.0
29 mlp.up_proj
Quantizing ...
time 0.53
error 46588048.0
29 mlp.down_proj
Quantizing ...
time 1.66

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 30/32 [07:26<00:29, 14.87s/it]
30 self_attn.q_proj
Quantizing ...
time 0.98
error 24673458.0
30 self_attn.k_proj
Quantizing ...
time 0.52
error 24696024.0
30 self_attn.v_proj
Quantizing ...
time 0.52
error 24675412.0
30 self_attn.o_proj
Quantizing ...
time 0.52
error 1620691.75
30 mlp.gate_proj
Quantizing ...
time 0.53
error 45763932.0
30 mlp.up_proj
Quantizing ...
time 0.53
error 45819948.0
30 mlp.down_proj
Quantizing ...
time 1.66

 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 31/32 [07:41<00:14, 14.88s/it]
31 self_attn.q_proj
Quantizing ...
time 1.00
error 16203090.0
31 self_attn.k_proj
Quantizing ...
time 0.52
error 16203809.0
31 self_attn.v_proj
Quantizing ...
time 0.52
error 16194348.0
31 self_attn.o_proj
Quantizing ...
time 0.52
error 2070095.5
31 mlp.gate_proj
Quantizing ...
time 0.53
error 35401472.0
31 mlp.up_proj
Quantizing ...
time 0.53
error 35414368.0
31 mlp.down_proj
Quantizing ...
time 1.65
error 33124340.0

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 32/32 [07:56<00:00, 14.88s/it]
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
5.2060112953186035