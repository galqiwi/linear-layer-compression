

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.03s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
  0%|                                                                                                                                                                                                     | 0/32 [00:00<?, ?it/s]
Starting ...
Ready.
0 self_attn.q_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.98
error 2961778.0
0 self_attn.k_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.53
error 1814657.75
0 self_attn.v_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.53
error 931027.0
0 self_attn.o_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.53
error 20447.16015625
0 mlp.gate_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.54
error 4192823.25
0 mlp.up_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 0.53
error 4168562.0
0 mlp.down_proj
Quantizing ...
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
128 2
time 1.66

  3%|█████▉                                                                                                                                                                                       | 1/32 [00:17<08:58, 17.37s/it]
Traceback (most recent call last):
  File "/nfs/scistore19/alistgrp/apanfero/CompressionEntropy/gptq/llama2.py", line 340, in <module>
    quantizers = llama_sequential(model, dataloader, DEV)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/nfs/scistore19/alistgrp/apanfero/CompressionEntropy/gptq/llama2.py", line 126, in llama_sequential
    outs[j] = layer(inps[j], attention_mask=attention_masks[j], position_ids=position_ids[j])[0]
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 795, in forward
    hidden_states = self.input_layernorm(hidden_states)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/transformers/models/llama/modeling_llama.py", line 115, in forward
    variance = hidden_states.pow(2).mean(-1, keepdim=True)
KeyboardInterrupt