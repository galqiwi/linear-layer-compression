

Loading checkpoint shards: 100%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.13s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
  0%|                                                                                                                                                                                                                                                                | 0/32 [00:00<?, ?it/s]
Starting ...
Ready.
0 self_attn.q_proj
Quantizing ...
time 0.87
error 222054.6875
0 self_attn.k_proj
Quantizing ...
time 0.42
error 223318.5
0 self_attn.v_proj
Quantizing ...
time 0.43
error 218708.84375
0 self_attn.o_proj
Quantizing ...
time 0.43
error 4107.0576171875
0 mlp.gate_proj
Quantizing ...
time 0.98
error 918665.75
0 mlp.up_proj
Quantizing ...
time 0.98
error 918274.625
0 mlp.down_proj
Quantizing ...
time 1.43

  3%|███████▊                                                                                                                                                                                                                                                | 1/32 [00:14<07:39, 14.82s/it]
1 self_attn.q_proj
Quantizing ...
time 0.85
error 1601942.5
1 self_attn.k_proj
Quantizing ...
time 0.43
error 1605330.5
1 self_attn.v_proj
Quantizing ...
time 0.43
error 1581634.0
1 self_attn.o_proj
Quantizing ...
time 0.43
error 32784.16796875
1 mlp.gate_proj
Quantizing ...
time 0.98
error 3074164.25
1 mlp.up_proj
Quantizing ...
time 0.98
error 3065319.0
1 mlp.down_proj
Quantizing ...
time 1.43

  6%|███████████████▌                                                                                                                                                                                                                                        | 2/32 [00:29<07:24, 14.80s/it]
2 self_attn.q_proj
Quantizing ...
time 0.85
error 5923066.0
2 self_attn.k_proj
Quantizing ...
time 0.43
error 5931920.5
2 self_attn.v_proj
Quantizing ...
time 0.43
error 5883084.0
2 self_attn.o_proj
Quantizing ...
time 0.43
error 59472.88671875
2 mlp.gate_proj
Quantizing ...
time 0.98
error 7337883.5
2 mlp.up_proj
Quantizing ...
time 0.98
error 7321017.5
2 mlp.down_proj
Quantizing ...
time 1.43

  9%|███████████████████████▎                                                                                                                                                                                                                                | 3/32 [00:44<07:09, 14.82s/it]
3 self_attn.q_proj
Quantizing ...
time 0.85
error 17374532.0
3 self_attn.k_proj
Quantizing ...
time 0.43
error 17386266.0
3 self_attn.v_proj
Quantizing ...
time 0.43
error 17293078.0
3 self_attn.o_proj
Quantizing ...
time 0.43
error 125418.53125
3 mlp.gate_proj
Quantizing ...
time 0.98
error 13147767.0
3 mlp.up_proj
Quantizing ...
time 0.98
error 13125700.0
3 mlp.down_proj
Quantizing ...
time 1.43

 12%|███████████████████████████████                                                                                                                                                                                                                         | 4/32 [00:59<06:55, 14.84s/it]
4 self_attn.q_proj
Quantizing ...
time 0.85
error 15925389.0
4 self_attn.k_proj
Quantizing ...
time 0.43
error 15943970.0
4 self_attn.v_proj
Quantizing ...
time 0.43
error 15844132.0
4 self_attn.o_proj
Quantizing ...
time 0.43
error 234521.671875
4 mlp.gate_proj
Quantizing ...
time 0.98
error 17950544.0
4 mlp.up_proj
Quantizing ...
time 0.98
error 17926592.0
4 mlp.down_proj
Quantizing ...
time 1.44

 16%|██████████████████████████████████████▊                                                                                                                                                                                                                 | 5/32 [01:14<06:41, 14.87s/it]
5 self_attn.q_proj
Quantizing ...
time 0.86
error 18189776.0
5 self_attn.k_proj
Quantizing ...
time 0.43
error 18204112.0
5 self_attn.v_proj
Quantizing ...
time 0.43
error 18102008.0
5 self_attn.o_proj
Quantizing ...
time 0.43
error 394801.0
5 mlp.gate_proj
Quantizing ...
time 0.98
error 22609266.0
5 mlp.up_proj
Quantizing ...
time 0.98
error 22564140.0
5 mlp.down_proj
Quantizing ...
time 1.44

 19%|██████████████████████████████████████████████▌                                                                                                                                                                                                         | 6/32 [01:29<06:26, 14.88s/it]
6 self_attn.q_proj
Quantizing ...
time 0.86
error 29509456.0
6 self_attn.k_proj
Quantizing ...
time 0.43
error 29515270.0
6 self_attn.v_proj
Quantizing ...
time 0.43
error 29340502.0
6 self_attn.o_proj
Quantizing ...
time 0.43
error 635233.5
6 mlp.gate_proj
Quantizing ...
time 0.98
error 27930052.0
6 mlp.up_proj
Quantizing ...
time 0.98
error 27864500.0
6 mlp.down_proj
Quantizing ...
time 1.44

 22%|██████████████████████████████████████████████████████▎                                                                                                                                                                                                 | 7/32 [01:44<06:12, 14.91s/it]
7 self_attn.q_proj
Quantizing ...
time 0.86
error 32358734.0
7 self_attn.k_proj
Quantizing ...
time 0.43
error 32335852.0
7 self_attn.v_proj
Quantizing ...
time 0.43
error 32149664.0
7 self_attn.o_proj
Quantizing ...
time 0.43
error 857698.0
7 mlp.gate_proj
Quantizing ...
time 0.98
error 32570784.0
7 mlp.up_proj
Quantizing ...
time 0.98
error 32504634.0
7 mlp.down_proj
Quantizing ...
time 1.44

 25%|██████████████████████████████████████████████████████████████                                                                                                                                                                                          | 8/32 [01:59<05:58, 14.93s/it]
8 self_attn.q_proj
Quantizing ...
time 0.86
error 31688220.0
8 self_attn.k_proj
Quantizing ...
time 0.43
error 31694980.0
8 self_attn.v_proj
Quantizing ...
time 0.43
error 31531190.0
8 self_attn.o_proj
Quantizing ...
time 0.43
error 1329722.5
8 mlp.gate_proj
Quantizing ...
time 0.98
error 34840672.0
8 mlp.up_proj
Quantizing ...
time 0.98
error 34777048.0
8 mlp.down_proj
Quantizing ...
time 1.44

 28%|█████████████████████████████████████████████████████████████████████▊                                                                                                                                                                                  | 9/32 [02:14<05:44, 14.96s/it]
9 self_attn.q_proj
Quantizing ...
time 0.86
error 33429204.0
9 self_attn.k_proj
Quantizing ...
time 0.43
error 33434760.0
9 self_attn.v_proj
Quantizing ...
time 0.43
error 33290788.0
9 self_attn.o_proj
Quantizing ...
time 0.43
error 1706525.5
9 mlp.gate_proj
Quantizing ...
time 0.98
error 37546828.0
9 mlp.up_proj
Quantizing ...
time 0.98
error 37476820.0
9 mlp.down_proj
Quantizing ...
time 1.45

 31%|█████████████████████████████████████████████████████████████████████████████▏                                                                                                                                                                         | 10/32 [02:29<05:29, 14.98s/it]
10 self_attn.q_proj
Quantizing ...
time 0.86
error 34537400.0
10 self_attn.k_proj
Quantizing ...
time 0.43
error 34557604.0
10 self_attn.v_proj
Quantizing ...
time 0.43
error 34399156.0
10 self_attn.o_proj
Quantizing ...
time 0.43
error 2420097.5
10 mlp.gate_proj
Quantizing ...
time 0.98
error 39133504.0
10 mlp.up_proj
Quantizing ...
time 0.98
error 39053380.0
10 mlp.down_proj
Quantizing ...
time 1.44

 34%|████████████████████████████████████████████████████████████████████████████████████▉                                                                                                                                                                  | 11/32 [02:44<05:14, 14.99s/it]
11 self_attn.q_proj
Quantizing ...
time 0.86
error 42330520.0
11 self_attn.k_proj
Quantizing ...
time 0.43
error 42373000.0
11 self_attn.v_proj
Quantizing ...
time 0.43
error 42188256.0
11 self_attn.o_proj
Quantizing ...
time 0.43
error 2351073.5
11 mlp.gate_proj
Quantizing ...
time 0.98
error 42813952.0
11 mlp.up_proj
Quantizing ...
time 0.98
error 42727960.0
11 mlp.down_proj
Quantizing ...
time 1.44

 38%|████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                                                                          | 12/32 [02:59<05:00, 15.00s/it]
12 self_attn.q_proj
Quantizing ...
time 0.86
error 42821396.0
12 self_attn.k_proj
Quantizing ...
time 0.43
error 42902832.0
12 self_attn.v_proj
Quantizing ...
time 0.43
error 42742072.0
12 self_attn.o_proj
Quantizing ...
time 0.43
error 2766545.0
12 mlp.gate_proj
Quantizing ...
time 0.98
error 45951708.0
12 mlp.up_proj
Quantizing ...
time 0.98
error 45875840.0
12 mlp.down_proj
Quantizing ...
time 1.45

 41%|████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                                                                                                                  | 13/32 [03:14<04:45, 15.01s/it]
13 self_attn.q_proj
Quantizing ...
time 0.86
error 44706004.0
13 self_attn.k_proj
Quantizing ...
time 0.43
error 44736208.0
13 self_attn.v_proj
Quantizing ...
time 0.43
error 44497344.0
13 self_attn.o_proj
Quantizing ...
time 0.43
error 2855049.5
13 mlp.gate_proj
Quantizing ...
time 0.98
error 48606712.0
13 mlp.up_proj
Quantizing ...
time 0.98
error 48546168.0
13 mlp.down_proj
Quantizing ...
time 1.44

 44%|████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                                                                           | 14/32 [03:29<04:30, 15.01s/it]
14 self_attn.q_proj
Quantizing ...
time 0.86
error 46146856.0
14 self_attn.k_proj
Quantizing ...
time 0.43
error 46227824.0
14 self_attn.v_proj
Quantizing ...
time 0.43
error 45962216.0
14 self_attn.o_proj
Quantizing ...
time 0.43
error 3509445.0
14 mlp.gate_proj
Quantizing ...
time 0.98
error 53493308.0
14 mlp.up_proj
Quantizing ...
time 0.98
error 53407636.0
14 mlp.down_proj
Quantizing ...
time 1.44

 47%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                                                                   | 15/32 [03:44<04:15, 15.02s/it]
15 self_attn.q_proj
Quantizing ...
time 0.86
error 44931648.0
15 self_attn.k_proj
Quantizing ...
time 0.43
error 45000384.0
15 self_attn.v_proj
Quantizing ...
time 0.43
error 44784964.0
15 self_attn.o_proj
Quantizing ...
time 0.43
error 3609271.0
15 mlp.gate_proj
Quantizing ...
time 0.98
error 57579448.0
15 mlp.up_proj
Quantizing ...
time 0.98
error 57481284.0
15 mlp.down_proj
Quantizing ...
time 1.45

 50%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                                                                           | 16/32 [03:59<04:00, 15.02s/it]
16 self_attn.q_proj
Quantizing ...
time 0.86
error 47150188.0
16 self_attn.k_proj
Quantizing ...
time 0.43
error 47236636.0
16 self_attn.v_proj
Quantizing ...
time 0.43
error 46969968.0
16 self_attn.o_proj
Quantizing ...
time 0.43
error 4393719.0
16 mlp.gate_proj
Quantizing ...
time 0.98
error 64634376.0
16 mlp.up_proj
Quantizing ...
time 0.98
error 64550580.0
16 mlp.down_proj
Quantizing ...
time 1.45

 53%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                                   | 17/32 [04:14<03:45, 15.03s/it]
17 self_attn.q_proj
Quantizing ...
time 0.86
error 49755080.0
17 self_attn.k_proj
Quantizing ...
time 0.43
error 49798116.0
17 self_attn.v_proj
Quantizing ...
time 0.43
error 49570448.0
17 self_attn.o_proj
Quantizing ...
time 0.43
error 3284055.0
17 mlp.gate_proj
Quantizing ...
time 0.98
error 73901728.0
17 mlp.up_proj
Quantizing ...
time 0.98
error 73787112.0
17 mlp.down_proj
Quantizing ...
time 1.45

 56%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                                            | 18/32 [04:29<03:30, 15.03s/it]
18 self_attn.q_proj
Quantizing ...
time 0.86
error 56220416.0
18 self_attn.k_proj
Quantizing ...
time 0.43
error 56215276.0
18 self_attn.v_proj
Quantizing ...
time 0.43
error 55967600.0
18 self_attn.o_proj
Quantizing ...
time 0.43
error 3529251.75
18 mlp.gate_proj
Quantizing ...
time 0.98
error 82852064.0
18 mlp.up_proj
Quantizing ...
time 0.98
error 82711072.0
18 mlp.down_proj
Quantizing ...
time 1.44

 59%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                                                    | 19/32 [04:44<03:15, 15.04s/it]
19 self_attn.q_proj
Quantizing ...
time 0.86
error 55570088.0
19 self_attn.k_proj
Quantizing ...
time 0.43
error 55652984.0
19 self_attn.v_proj
Quantizing ...
time 0.43
error 55447976.0
19 self_attn.o_proj
Quantizing ...
time 0.43
error 3238673.5
19 mlp.gate_proj
Quantizing ...
time 0.98
error 88969368.0
19 mlp.up_proj
Quantizing ...
time 0.98
error 88865952.0
19 mlp.down_proj
Quantizing ...
time 1.45

 62%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                                            | 20/32 [04:59<03:00, 15.03s/it]
20 self_attn.q_proj
Quantizing ...
time 0.86
error 56374300.0
20 self_attn.k_proj
Quantizing ...
time 0.43
error 56401744.0
20 self_attn.v_proj
Quantizing ...
time 0.43
error 56145784.0
20 self_attn.o_proj
Quantizing ...
time 0.43
error 3421087.0
20 mlp.gate_proj
Quantizing ...
time 0.98
error 93686592.0
20 mlp.up_proj
Quantizing ...
time 0.98
error 93605800.0
20 mlp.down_proj
Quantizing ...
time 1.45

 66%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                                                                     | 21/32 [05:14<02:45, 15.03s/it]
21 self_attn.q_proj
Quantizing ...
time 0.86
error 62579316.0
21 self_attn.k_proj
Quantizing ...
time 0.43
error 62643744.0
21 self_attn.v_proj
Quantizing ...
time 0.43
error 62336240.0
21 self_attn.o_proj
Quantizing ...
time 0.43
error 3245376.5
21 mlp.gate_proj
Quantizing ...
time 0.98
error 100260488.0
21 mlp.up_proj
Quantizing ...
time 0.98
error 100129040.0
21 mlp.down_proj
Quantizing ...
time 1.45

 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                             | 22/32 [05:29<02:30, 15.03s/it]
22 self_attn.q_proj
Quantizing ...
time 0.86
error 64501224.0
22 self_attn.k_proj
Quantizing ...
time 0.43
error 64536888.0
22 self_attn.v_proj
Quantizing ...
time 0.43
error 64284488.0
22 self_attn.o_proj
Quantizing ...
time 0.43
error 3842585.25
22 mlp.gate_proj
Quantizing ...
time 0.98
error 105265544.0
22 mlp.up_proj
Quantizing ...
time 0.98
error 105206520.0
22 mlp.down_proj
Quantizing ...
time 1.44

 72%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                     | 23/32 [05:44<02:15, 15.03s/it]
23 self_attn.q_proj
Quantizing ...
time 0.86
error 71776936.0
23 self_attn.k_proj
Quantizing ...
time 0.43
error 71768688.0
23 self_attn.v_proj
Quantizing ...
time 0.43
error 71578224.0
23 self_attn.o_proj
Quantizing ...
time 0.43
error 3658497.0
23 mlp.gate_proj
Quantizing ...
time 0.98
error 112674896.0
23 mlp.up_proj
Quantizing ...
time 0.98
error 112520320.0
23 mlp.down_proj
Quantizing ...
time 1.45

 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                             | 24/32 [05:59<02:00, 15.04s/it]
24 self_attn.q_proj
Quantizing ...
time 0.86
error 70227448.0
24 self_attn.k_proj
Quantizing ...
time 0.43
error 70319296.0
24 self_attn.v_proj
Quantizing ...
time 0.43
error 70003296.0
24 self_attn.o_proj
Quantizing ...
time 0.43
error 4089685.5
24 mlp.gate_proj
Quantizing ...
time 0.98
error 118151696.0
24 mlp.up_proj
Quantizing ...
time 0.98
error 118050688.0
24 mlp.down_proj
Quantizing ...
time 1.45

 78%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                                      | 25/32 [06:14<01:45, 15.04s/it]
25 self_attn.q_proj
Quantizing ...
time 0.86
error 80942800.0
25 self_attn.k_proj
Quantizing ...
time 0.43
error 80972264.0
25 self_attn.v_proj
Quantizing ...
time 0.43
error 80771456.0
25 self_attn.o_proj
Quantizing ...
time 0.43
error 2999726.25
25 mlp.gate_proj
Quantizing ...
time 0.98
error 126262032.0
25 mlp.up_proj
Quantizing ...
time 0.98
error 126163848.0
25 mlp.down_proj
Quantizing ...
time 1.45

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                              | 26/32 [06:29<01:30, 15.04s/it]
26 self_attn.q_proj
Quantizing ...
time 0.86
error 77716088.0
26 self_attn.k_proj
Quantizing ...
time 0.43
error 77743504.0
26 self_attn.v_proj
Quantizing ...
time 0.43
error 77545952.0
26 self_attn.o_proj
Quantizing ...
time 0.43
error 4659601.0
26 mlp.gate_proj
Quantizing ...
time 0.98
error 132720552.0
26 mlp.up_proj
Quantizing ...
time 0.98
error 132589648.0
26 mlp.down_proj
Quantizing ...
time 1.44

 84%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                      | 27/32 [06:44<01:15, 15.05s/it]
27 self_attn.q_proj
Quantizing ...
time 0.86
error 79723632.0
27 self_attn.k_proj
Quantizing ...
time 0.43
error 79693880.0
27 self_attn.v_proj
Quantizing ...
time 0.43
error 79529768.0
27 self_attn.o_proj
Quantizing ...
time 0.43
error 4141727.25
27 mlp.gate_proj
Quantizing ...
time 0.98
error 140530048.0
27 mlp.up_proj
Quantizing ...
time 0.98
error 140476128.0
27 mlp.down_proj
Quantizing ...
time 1.45

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                              | 28/32 [06:59<01:00, 15.04s/it]
28 self_attn.q_proj
Quantizing ...
time 0.86
error 82186576.0
28 self_attn.k_proj
Quantizing ...
time 0.43
error 82225632.0
28 self_attn.v_proj
Quantizing ...
time 0.43
error 82066720.0
28 self_attn.o_proj
Quantizing ...
time 0.43
error 4655359.0
28 mlp.gate_proj
Quantizing ...
time 0.98
error 146562624.0
28 mlp.up_proj
Quantizing ...
time 0.98
error 146464544.0
28 mlp.down_proj
Quantizing ...
time 1.47

 91%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                       | 29/32 [07:14<00:45, 15.05s/it]
29 self_attn.q_proj
Quantizing ...
time 0.86
error 75963312.0
29 self_attn.k_proj
Quantizing ...
time 0.43
error 76101536.0
29 self_attn.v_proj
Quantizing ...
time 0.43
error 75824296.0
29 self_attn.o_proj
Quantizing ...
time 0.43
error 4540585.0
29 mlp.gate_proj
Quantizing ...
time 0.98
error 150158720.0
29 mlp.up_proj
Quantizing ...
time 0.98
error 150183504.0
29 mlp.down_proj
Quantizing ...
time 1.44

 94%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌               | 30/32 [07:29<00:30, 15.05s/it]
30 self_attn.q_proj
Quantizing ...
time 0.86
error 79782624.0
30 self_attn.k_proj
Quantizing ...
time 0.43
error 79827080.0
30 self_attn.v_proj
Quantizing ...
time 0.43
error 79605904.0
30 self_attn.o_proj
Quantizing ...
time 0.43
error 5178601.5
30 mlp.gate_proj
Quantizing ...
time 0.98
error 147527168.0
30 mlp.up_proj
Quantizing ...
time 0.98
error 147497088.0
30 mlp.down_proj
Quantizing ...
time 1.45

 97%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎       | 31/32 [07:44<00:15, 15.04s/it]
31 self_attn.q_proj
Quantizing ...
time 0.86
error 52532048.0
31 self_attn.k_proj
Quantizing ...
time 0.43
error 52582296.0
31 self_attn.v_proj
Quantizing ...
time 0.43
error 52396448.0
31 self_attn.o_proj
Quantizing ...
time 0.43
error 6870754.0
31 mlp.gate_proj
Quantizing ...
time 0.98
error 114451192.0
31 mlp.up_proj
Quantizing ...
time 0.98
error 114489192.0
31 mlp.down_proj
Quantizing ...
time 1.45
error 109888384.0

100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 32/32 [07:59<00:00, 15.00s/it]
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
5.459256172180176