

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.14s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
  0%|                                                                                                                                                                                                     | 0/32 [00:00<?, ?it/s]
Starting ...
Ready.
0 self_attn.q_proj
Quantizing ...
time 0.97
error 2961778.0
0 self_attn.k_proj
Quantizing ...
time 0.52
error 1814657.75
0 self_attn.v_proj
Quantizing ...
time 0.52
error 931027.0
0 self_attn.o_proj
Quantizing ...
time 0.53
error 20447.16015625
0 mlp.gate_proj
Quantizing ...
time 0.53
error 4192823.25
0 mlp.up_proj
Quantizing ...
time 0.53
error 4168562.0
0 mlp.down_proj
Quantizing ...
time 1.66

  3%|█████▉                                                                                                                                                                                       | 1/32 [00:14<07:29, 14.51s/it]
1 self_attn.q_proj
Quantizing ...
time 0.95
error 7398517.0
1 self_attn.k_proj
Quantizing ...
time 0.52
error 7412226.0
1 self_attn.v_proj
Quantizing ...
time 0.53
error 6718590.0
1 self_attn.o_proj
Quantizing ...
time 0.53
error 165780.1875
1 mlp.gate_proj
Quantizing ...
time 0.53
error 14241342.0
1 mlp.up_proj
Quantizing ...
time 0.53
error 13896574.0
1 mlp.down_proj
Quantizing ...
time 1.66

  6%|███████████▊                                                                                                                                                                                 | 2/32 [00:29<07:15, 14.52s/it]
2 self_attn.q_proj
Quantizing ...
time 0.98
error 26459224.0
2 self_attn.k_proj
Quantizing ...
time 0.53
error 26616466.0
2 self_attn.v_proj
Quantizing ...
time 0.52
error 25165392.0
2 self_attn.o_proj
Quantizing ...
time 0.52
error 188825.03125
2 mlp.gate_proj
Quantizing ...
time 0.53
error 31753552.0
2 mlp.up_proj
Quantizing ...
time 0.54
error 31280656.0
2 mlp.down_proj
Quantizing ...
time 1.66

  9%|█████████████████▋                                                                                                                                                                           | 3/32 [00:43<07:03, 14.59s/it]
3 self_attn.q_proj
Quantizing ...
time 0.98
error 72922840.0
3 self_attn.k_proj
Quantizing ...
time 0.53
error 73404880.0
3 self_attn.v_proj
Quantizing ...
time 0.53
error 70401968.0
3 self_attn.o_proj
Quantizing ...
time 0.53
error 407933.53125
3 mlp.gate_proj
Quantizing ...
time 0.53
error 53201888.0
3 mlp.up_proj
Quantizing ...
time 0.53
error 52806472.0
3 mlp.down_proj
Quantizing ...
time 1.66

 12%|███████████████████████▋                                                                                                                                                                     | 4/32 [00:58<06:50, 14.67s/it]
4 self_attn.q_proj
Quantizing ...
time 0.97
error 66221996.0
4 self_attn.k_proj
Quantizing ...
time 0.54
error 66808632.0
4 self_attn.v_proj
Quantizing ...
time 0.53
error 64020028.0
4 self_attn.o_proj
Quantizing ...
time 0.53
error 828647.25
4 mlp.gate_proj
Quantizing ...
time 0.53
error 72542112.0
4 mlp.up_proj
Quantizing ...
time 0.53
error 71871616.0
4 mlp.down_proj
Quantizing ...
time 1.66

 16%|█████████████████████████████▌                                                                                                                                                               | 5/32 [01:13<06:37, 14.71s/it]
5 self_attn.q_proj
Quantizing ...
time 0.98
error 74164320.0
5 self_attn.k_proj
Quantizing ...
time 0.53
error 74675680.0
5 self_attn.v_proj
Quantizing ...
time 0.53
error 71884528.0
5 self_attn.o_proj
Quantizing ...
time 0.52
error 1631328.75
5 mlp.gate_proj
Quantizing ...
time 0.53
error 88472880.0
5 mlp.up_proj
Quantizing ...
time 0.53
error 87468424.0
5 mlp.down_proj
Quantizing ...
time 1.66

 19%|███████████████████████████████████▍                                                                                                                                                         | 6/32 [01:28<06:23, 14.74s/it]
6 self_attn.q_proj
Quantizing ...
time 0.98
error 120560528.0
6 self_attn.k_proj
Quantizing ...
time 0.52
error 120700000.0
6 self_attn.v_proj
Quantizing ...
time 0.53
error 116329096.0
6 self_attn.o_proj
Quantizing ...
time 0.53
error 2804321.0
6 mlp.gate_proj
Quantizing ...
time 0.53
error 110149104.0
6 mlp.up_proj
Quantizing ...
time 0.53
error 108782712.0
6 mlp.down_proj
Quantizing ...
time 1.67

 22%|█████████████████████████████████████████▎                                                                                                                                                   | 7/32 [01:42<06:08, 14.75s/it]
7 self_attn.q_proj
Quantizing ...
time 0.99
error 133836152.0
7 self_attn.k_proj
Quantizing ...
time 0.52
error 133845008.0
7 self_attn.v_proj
Quantizing ...
time 0.52
error 128752928.0
7 self_attn.o_proj
Quantizing ...
time 0.52
error 3970766.5
7 mlp.gate_proj
Quantizing ...
time 0.53
error 127885240.0
7 mlp.up_proj
Quantizing ...
time 0.53
error 126412096.0
7 mlp.down_proj
Quantizing ...
time 1.66

 25%|███████████████████████████████████████████████▎                                                                                                                                             | 8/32 [01:57<05:54, 14.77s/it]
8 self_attn.q_proj
Quantizing ...
time 0.98
error 129374128.0
8 self_attn.k_proj
Quantizing ...
time 0.53
error 129593784.0
8 self_attn.v_proj
Quantizing ...
time 0.53
error 126080096.0
8 self_attn.o_proj
Quantizing ...
time 0.53
error 6067271.5
8 mlp.gate_proj
Quantizing ...
time 0.53
error 134767520.0
8 mlp.up_proj
Quantizing ...
time 0.53
error 133388192.0
8 mlp.down_proj
Quantizing ...
time 1.67

 28%|█████████████████████████████████████████████████████▏                                                                                                                                       | 9/32 [02:12<05:39, 14.75s/it]
9 self_attn.q_proj
Quantizing ...
time 0.97
error 136806272.0
9 self_attn.k_proj
Quantizing ...
time 0.52
error 137064544.0
9 self_attn.v_proj
Quantizing ...
time 0.52
error 132971760.0
9 self_attn.o_proj
Quantizing ...
time 0.52
error 7670098.0
9 mlp.gate_proj
Quantizing ...
time 0.53
error 147131152.0
9 mlp.up_proj
Quantizing ...
time 0.53
error 145701024.0
9 mlp.down_proj
Quantizing ...
time 1.66

 31%|██████████████████████████████████████████████████████████▊                                                                                                                                 | 10/32 [02:27<05:24, 14.75s/it]
10 self_attn.q_proj
Quantizing ...
time 0.98
error 142548672.0
10 self_attn.k_proj
Quantizing ...
time 0.52
error 143115424.0
10 self_attn.v_proj
Quantizing ...
time 0.52
error 138651136.0
10 self_attn.o_proj
Quantizing ...
time 0.52
error 10909100.0
10 mlp.gate_proj
Quantizing ...
time 0.53
error 154202624.0
10 mlp.up_proj
Quantizing ...
time 0.53
error 152809216.0
10 mlp.down_proj
Quantizing ...
time 1.66

 34%|████████████████████████████████████████████████████████████████▋                                                                                                                           | 11/32 [02:41<05:09, 14.76s/it]
11 self_attn.q_proj
Quantizing ...
time 0.96
error 174799696.0
11 self_attn.k_proj
Quantizing ...
time 0.53
error 175831216.0
11 self_attn.v_proj
Quantizing ...
time 0.53
error 171057568.0
11 self_attn.o_proj
Quantizing ...
time 0.53
error 11383928.0
11 mlp.gate_proj
Quantizing ...
time 0.53
error 169382464.0
11 mlp.up_proj
Quantizing ...
time 0.53
error 167808384.0
11 mlp.down_proj
Quantizing ...
time 1.67

 38%|██████████████████████████████████████████████████████████████████████▌                                                                                                                     | 12/32 [02:56<04:55, 14.76s/it]
12 self_attn.q_proj
Quantizing ...
time 1.01
error 175920704.0
12 self_attn.k_proj
Quantizing ...
time 0.53
error 177294304.0
12 self_attn.v_proj
Quantizing ...
time 0.54
error 172937440.0
12 self_attn.o_proj
Quantizing ...
time 0.53
error 13155459.0
12 mlp.gate_proj
Quantizing ...
time 0.53
error 181599776.0
12 mlp.up_proj
Quantizing ...
time 0.54
error 180197024.0
12 mlp.down_proj
Quantizing ...
time 1.68

 41%|████████████████████████████████████████████████████████████████████████████▍                                                                                                               | 13/32 [03:11<04:40, 14.79s/it]
13 self_attn.q_proj
Quantizing ...
time 0.98
error 182891792.0
13 self_attn.k_proj
Quantizing ...
time 0.53
error 183381888.0
13 self_attn.v_proj
Quantizing ...
time 0.53
error 178513648.0
13 self_attn.o_proj
Quantizing ...
time 0.53
error 13118732.0
13 mlp.gate_proj
Quantizing ...
time 0.53
error 193620864.0
13 mlp.up_proj
Quantizing ...
time 0.53
error 192087744.0
13 mlp.down_proj
Quantizing ...
time 1.66

 44%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                         | 14/32 [03:26<04:25, 14.77s/it]
14 self_attn.q_proj
Quantizing ...
time 0.98
error 190053856.0
14 self_attn.k_proj
Quantizing ...
time 0.52
error 191481600.0
14 self_attn.v_proj
Quantizing ...
time 0.52
error 185371072.0
14 self_attn.o_proj
Quantizing ...
time 0.53
error 16306862.0
14 mlp.gate_proj
Quantizing ...
time 0.53
error 213864256.0
14 mlp.up_proj
Quantizing ...
time 0.52
error 212176400.0
14 mlp.down_proj
Quantizing ...
time 1.66

 47%|████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 15/32 [03:40<04:10, 14.76s/it]
15 self_attn.q_proj
Quantizing ...
time 0.98
error 184495168.0
15 self_attn.k_proj
Quantizing ...
time 0.53
error 186268608.0
15 self_attn.v_proj
Quantizing ...
time 0.53
error 181201280.0
15 self_attn.o_proj
Quantizing ...
time 0.53
error 16741516.0
15 mlp.gate_proj
Quantizing ...
time 0.53
error 228565968.0
15 mlp.up_proj
Quantizing ...
time 0.53
error 226842096.0
15 mlp.down_proj
Quantizing ...
time 1.66

 50%|██████████████████████████████████████████████████████████████████████████████████████████████                                                                                              | 16/32 [03:55<03:56, 14.76s/it]
16 self_attn.q_proj
Quantizing ...
time 0.99
error 191832320.0
16 self_attn.k_proj
Quantizing ...
time 0.52
error 193455936.0
16 self_attn.v_proj
Quantizing ...
time 0.52
error 187271728.0
16 self_attn.o_proj
Quantizing ...
time 0.52
error 20082768.0
16 mlp.gate_proj
Quantizing ...
time 0.53
error 256234272.0
16 mlp.up_proj
Quantizing ...
time 0.53
error 254420736.0
16 mlp.down_proj
Quantizing ...
time 1.65

 53%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                        | 17/32 [04:10<03:41, 14.75s/it]
17 self_attn.q_proj
Quantizing ...
time 0.98
error 197728736.0
17 self_attn.k_proj
Quantizing ...
time 0.52
error 199054304.0
17 self_attn.v_proj
Quantizing ...
time 0.53
error 193995536.0
17 self_attn.o_proj
Quantizing ...
time 0.52
error 15096737.0
17 mlp.gate_proj
Quantizing ...
time 0.53
error 288726848.0
17 mlp.up_proj
Quantizing ...
time 0.53
error 286325696.0
17 mlp.down_proj
Quantizing ...
time 1.67

 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                  | 18/32 [04:25<03:26, 14.75s/it]
18 self_attn.q_proj
Quantizing ...
time 0.99
error 220831520.0
18 self_attn.k_proj
Quantizing ...
time 0.53
error 221423840.0
18 self_attn.v_proj
Quantizing ...
time 0.52
error 216318592.0
18 self_attn.o_proj
Quantizing ...
time 0.53
error 15558829.0
18 mlp.gate_proj
Quantizing ...
time 0.55
error 317456448.0
18 mlp.up_proj
Quantizing ...
time 0.53
error 315080256.0
18 mlp.down_proj
Quantizing ...
time 1.66

 59%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                            | 19/32 [04:39<03:11, 14.75s/it]
19 self_attn.q_proj
Quantizing ...
time 0.96
error 215137248.0
19 self_attn.k_proj
Quantizing ...
time 0.52
error 216423520.0
19 self_attn.v_proj
Quantizing ...
time 0.52
error 211731552.0
19 self_attn.o_proj
Quantizing ...
time 0.52
error 14270755.0
19 mlp.gate_proj
Quantizing ...
time 0.53
error 336261632.0
19 mlp.up_proj
Quantizing ...
time 0.53
error 334049024.0
19 mlp.down_proj
Quantizing ...
time 1.66

 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                      | 20/32 [04:54<02:56, 14.73s/it]
20 self_attn.q_proj
Quantizing ...
time 0.98
error 216789408.0
20 self_attn.k_proj
Quantizing ...
time 0.52
error 217729584.0
20 self_attn.v_proj
Quantizing ...
time 0.52
error 211962016.0
20 self_attn.o_proj
Quantizing ...
time 0.53
error 16664522.0
20 mlp.gate_proj
Quantizing ...
time 0.53
error 349033344.0
20 mlp.up_proj
Quantizing ...
time 0.53
error 346683456.0
20 mlp.down_proj
Quantizing ...
time 1.67

 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                | 21/32 [05:09<02:42, 14.73s/it]
21 self_attn.q_proj
Quantizing ...
time 0.97
error 235246464.0
21 self_attn.k_proj
Quantizing ...
time 0.52
error 236160480.0
21 self_attn.v_proj
Quantizing ...
time 0.52
error 230638368.0
21 self_attn.o_proj
Quantizing ...
time 0.52
error 15451148.0
21 mlp.gate_proj
Quantizing ...
time 0.53
error 368664256.0
21 mlp.up_proj
Quantizing ...
time 0.53
error 366122176.0
21 mlp.down_proj
Quantizing ...
time 1.69

 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 22/32 [05:24<02:27, 14.74s/it]
22 self_attn.q_proj
Quantizing ...
time 0.98
error 241509984.0
22 self_attn.k_proj
Quantizing ...
time 0.52
error 242046784.0
22 self_attn.v_proj
Quantizing ...
time 0.53
error 237220512.0
22 self_attn.o_proj
Quantizing ...
time 0.52
error 18349400.0
22 mlp.gate_proj
Quantizing ...
time 0.53
error 375111616.0
22 mlp.up_proj
Quantizing ...
time 0.53
error 372883456.0
22 mlp.down_proj
Quantizing ...
time 1.68

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 23/32 [05:38<02:12, 14.75s/it]
23 self_attn.q_proj
Quantizing ...
time 0.98
error 261638880.0
23 self_attn.k_proj
Quantizing ...
time 0.53
error 262179120.0
23 self_attn.v_proj
Quantizing ...
time 0.52
error 258578624.0
23 self_attn.o_proj
Quantizing ...
time 0.52
error 15126360.0
23 mlp.gate_proj
Quantizing ...
time 0.53
error 401645344.0
23 mlp.up_proj
Quantizing ...
time 0.53
error 399263040.0
23 mlp.down_proj
Quantizing ...
time 1.66

 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                               | 24/32 [05:53<01:58, 14.77s/it]
24 self_attn.q_proj
Quantizing ...
time 0.99
error 256283552.0
24 self_attn.k_proj
Quantizing ...
time 0.52
error 257695584.0
24 self_attn.v_proj
Quantizing ...
time 0.52
error 252616352.0
24 self_attn.o_proj
Quantizing ...
time 0.52
error 20147398.0
24 mlp.gate_proj
Quantizing ...
time 0.53
error 412493824.0
24 mlp.up_proj
Quantizing ...
time 0.53
error 410377408.0
24 mlp.down_proj
Quantizing ...
time 1.67

 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 25/32 [06:08<01:43, 14.76s/it]
25 self_attn.q_proj
Quantizing ...
time 0.98
error 286145088.0
25 self_attn.k_proj
Quantizing ...
time 0.53
error 286281888.0
25 self_attn.v_proj
Quantizing ...
time 0.53
error 282728064.0
25 self_attn.o_proj
Quantizing ...
time 0.53
error 13146590.0
25 mlp.gate_proj
Quantizing ...
time 0.53
error 438247904.0
25 mlp.up_proj
Quantizing ...
time 0.53
error 436163904.0
25 mlp.down_proj
Quantizing ...
time 1.66

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 26/32 [06:23<01:28, 14.78s/it]
26 self_attn.q_proj
Quantizing ...
time 0.99
error 276010048.0
26 self_attn.k_proj
Quantizing ...
time 0.53
error 277129344.0
26 self_attn.v_proj
Quantizing ...
time 0.53
error 272277248.0
26 self_attn.o_proj
Quantizing ...
time 0.53
error 23022298.0
26 mlp.gate_proj
Quantizing ...
time 0.53
error 445979904.0
26 mlp.up_proj
Quantizing ...
time 0.53
error 444135296.0
26 mlp.down_proj
Quantizing ...
time 1.66

 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 27/32 [06:38<01:13, 14.76s/it]
27 self_attn.q_proj
Quantizing ...
time 0.98
error 271574496.0
27 self_attn.k_proj
Quantizing ...
time 0.53
error 271856576.0
27 self_attn.v_proj
Quantizing ...
time 0.52
error 268206112.0
27 self_attn.o_proj
Quantizing ...
time 0.53
error 14449613.0
27 mlp.gate_proj
Quantizing ...
time 0.53
error 468212864.0
27 mlp.up_proj
Quantizing ...
time 0.53
error 466540800.0
27 mlp.down_proj
Quantizing ...
time 1.66

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 28/32 [06:52<00:59, 14.77s/it]
28 self_attn.q_proj
Quantizing ...
time 0.98
error 281612832.0
28 self_attn.k_proj
Quantizing ...
time 0.53
error 282040128.0
28 self_attn.v_proj
Quantizing ...
time 0.52
error 277833600.0
28 self_attn.o_proj
Quantizing ...
time 0.52
error 17799460.0
28 mlp.gate_proj
Quantizing ...
time 0.53
error 488296128.0
28 mlp.up_proj
Quantizing ...
time 0.53
error 486978496.0
28 mlp.down_proj
Quantizing ...
time 1.67

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 29/32 [07:07<00:44, 14.76s/it]
29 self_attn.q_proj
Quantizing ...
time 0.96
error 258646288.0
29 self_attn.k_proj
Quantizing ...
time 0.53
error 260310912.0
29 self_attn.v_proj
Quantizing ...
time 0.53
error 255217088.0
29 self_attn.o_proj
Quantizing ...
time 0.53
error 17696944.0
29 mlp.gate_proj
Quantizing ...
time 0.53
error 492735616.0
29 mlp.up_proj
Quantizing ...
time 0.53
error 492162464.0
29 mlp.down_proj
Quantizing ...
time 1.66

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 30/32 [07:22<00:29, 14.76s/it]
30 self_attn.q_proj
Quantizing ...
time 0.98
error 265960144.0
30 self_attn.k_proj
Quantizing ...
time 0.52
error 266666896.0
30 self_attn.v_proj
Quantizing ...
time 0.53
error 262181664.0
30 self_attn.o_proj
Quantizing ...
time 0.52
error 17312216.0
30 mlp.gate_proj
Quantizing ...
time 0.53
error 478357952.0
30 mlp.up_proj
Quantizing ...
time 0.53
error 478425088.0
30 mlp.down_proj
Quantizing ...
time 1.66

 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 31/32 [07:37<00:14, 14.76s/it]
31 self_attn.q_proj
Quantizing ...
time 1.00
error 176958688.0
31 self_attn.k_proj
Quantizing ...
time 0.53
error 177834000.0
31 self_attn.v_proj
Quantizing ...
time 0.52
error 173801744.0
31 self_attn.o_proj
Quantizing ...
time 0.52
error 28037596.0
31 mlp.gate_proj
Quantizing ...
time 0.53
error 373862880.0
31 mlp.up_proj
Quantizing ...
time 0.53
error 373683072.0
31 mlp.down_proj
Quantizing ...
time 1.67

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 32/32 [07:51<00:00, 14.75s/it]
472.37822675704956
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
8.632890701293945