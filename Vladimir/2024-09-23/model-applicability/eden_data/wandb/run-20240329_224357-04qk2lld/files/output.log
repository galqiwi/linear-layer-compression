

Loading checkpoint shards: 100%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 2/2 [00:02<00:00,  1.12s/it]
/nfs/scistore19/alistgrp/apanfero/GPTAQ/.conda/lib/python3.10/site-packages/datasets/load.py:1429: FutureWarning: The repository for togethercomputer/RedPajama-Data-1T-Sample contains custom code which must be executed to correctly load the dataset. You can inspect the repository content at https://hf.co/datasets/togethercomputer/RedPajama-Data-1T-Sample
You can avoid this message in future by passing the argument `trust_remote_code=True`.
Passing `trust_remote_code=True` will be mandatory to load this dataset from the next major release of `datasets`.
  warnings.warn(
Starting ...
Ready.
  0%|                                                                                                                                                                                                     | 0/32 [00:00<?, ?it/s]
0 self_attn.q_proj
Quantizing ...
time 0.96
error 255940.5
0 self_attn.k_proj
Quantizing ...
time 0.52
error 258067.15625
0 self_attn.v_proj
Quantizing ...
time 0.52
error 251958.28125
0 self_attn.o_proj
Quantizing ...
time 0.52
error 4782.36572265625
0 mlp.gate_proj
Quantizing ...
time 0.53
error 1062453.125
0 mlp.up_proj
Quantizing ...
time 0.52
error 1061582.25
0 mlp.down_proj
Quantizing ...
time 1.64

  3%|█████▉                                                                                                                                                                                       | 1/32 [00:14<07:30, 14.53s/it]
1 self_attn.q_proj
Quantizing ...
time 0.95
error 1853817.75
1 self_attn.k_proj
Quantizing ...
time 0.52
error 1854644.75
1 self_attn.v_proj
Quantizing ...
time 0.52
error 1824367.0
1 self_attn.o_proj
Quantizing ...
time 0.52
error 38219.1953125
1 mlp.gate_proj
Quantizing ...
time 0.53
error 3557087.75
1 mlp.up_proj
Quantizing ...
time 0.53
error 3543952.0
1 mlp.down_proj
Quantizing ...
time 1.64

  6%|███████████▊                                                                                                                                                                                 | 2/32 [00:29<07:16, 14.56s/it]
2 self_attn.q_proj
Quantizing ...
time 0.98
error 6828004.5
2 self_attn.k_proj
Quantizing ...
time 0.52
error 6843064.5
2 self_attn.v_proj
Quantizing ...
time 0.52
error 6776482.0
2 self_attn.o_proj
Quantizing ...
time 0.52
error 67247.78125
2 mlp.gate_proj
Quantizing ...
time 0.53
error 8455923.0
2 mlp.up_proj
Quantizing ...
time 0.52
error 8427831.0
2 mlp.down_proj
Quantizing ...
time 1.64

  9%|█████████████████▋                                                                                                                                                                           | 3/32 [00:43<07:05, 14.67s/it]
3 self_attn.q_proj
Quantizing ...
time 0.99
error 20004336.0
3 self_attn.k_proj
Quantizing ...
time 0.52
error 20041808.0
3 self_attn.v_proj
Quantizing ...
time 0.52
error 19902970.0
3 self_attn.o_proj
Quantizing ...
time 0.52
error 140258.46875
3 mlp.gate_proj
Quantizing ...
time 0.53
error 15104644.0
3 mlp.up_proj
Quantizing ...
time 0.52
error 15070942.0
3 mlp.down_proj
Quantizing ...
time 1.64

 12%|███████████████████████▋                                                                                                                                                                     | 4/32 [00:58<06:54, 14.82s/it]
4 self_attn.q_proj
Quantizing ...
time 1.00
error 18335750.0
4 self_attn.k_proj
Quantizing ...
time 0.52
error 18356740.0
4 self_attn.v_proj
Quantizing ...
time 0.52
error 18209888.0
4 self_attn.o_proj
Quantizing ...
time 0.52
error 255861.484375
4 mlp.gate_proj
Quantizing ...
time 0.53
error 20782968.0
4 mlp.up_proj
Quantizing ...
time 0.53
error 20745996.0
4 mlp.down_proj
Quantizing ...
time 1.66

 16%|█████████████████████████████▌                                                                                                                                                               | 5/32 [01:14<06:43, 14.95s/it]
5 self_attn.q_proj
Quantizing ...
time 1.03
error 20820074.0
5 self_attn.k_proj
Quantizing ...
time 0.52
error 20823916.0
5 self_attn.v_proj
Quantizing ...
time 0.52
error 20688856.0
5 self_attn.o_proj
Quantizing ...
time 0.52
error 461409.0625
5 mlp.gate_proj
Quantizing ...
time 0.52
error 25747272.0
5 mlp.up_proj
Quantizing ...
time 0.52
error 25693726.0
5 mlp.down_proj
Quantizing ...
time 1.66

 19%|███████████████████████████████████▍                                                                                                                                                         | 6/32 [01:29<06:30, 15.02s/it]
6 self_attn.q_proj
Quantizing ...
time 0.99
error 33703088.0
6 self_attn.k_proj
Quantizing ...
time 0.52
error 33734424.0
6 self_attn.v_proj
Quantizing ...
time 0.52
error 33513758.0
6 self_attn.o_proj
Quantizing ...
time 0.52
error 722462.0
6 mlp.gate_proj
Quantizing ...
time 0.53
error 31803474.0
6 mlp.up_proj
Quantizing ...
time 0.53
error 31708974.0
6 mlp.down_proj
Quantizing ...
time 1.66

 22%|█████████████████████████████████████████▎                                                                                                                                                   | 7/32 [01:44<06:16, 15.08s/it]
7 self_attn.q_proj
Quantizing ...
time 0.99
error 36969596.0
7 self_attn.k_proj
Quantizing ...
time 0.52
error 36970104.0
7 self_attn.v_proj
Quantizing ...
time 0.52
error 36695388.0
7 self_attn.o_proj
Quantizing ...
time 0.52
error 984037.75
7 mlp.gate_proj
Quantizing ...
time 0.52
error 37014784.0
7 mlp.up_proj
Quantizing ...
time 0.52
error 36908192.0
7 mlp.down_proj
Quantizing ...
time 1.65

 25%|███████████████████████████████████████████████▎                                                                                                                                             | 8/32 [01:59<06:03, 15.13s/it]
8 self_attn.q_proj
Quantizing ...
time 1.00
error 36203924.0
8 self_attn.k_proj
Quantizing ...
time 0.52
error 36211556.0
8 self_attn.v_proj
Quantizing ...
time 0.52
error 36012760.0
8 self_attn.o_proj
Quantizing ...
time 0.52
error 1525919.25
8 mlp.gate_proj
Quantizing ...
time 0.53
error 39656340.0
8 mlp.up_proj
Quantizing ...
time 0.53
error 39565400.0
8 mlp.down_proj
Quantizing ...
time 1.67

 28%|█████████████████████████████████████████████████████▏                                                                                                                                       | 9/32 [02:15<05:50, 15.22s/it]
9 self_attn.q_proj
Quantizing ...
time 0.99
error 38220588.0
9 self_attn.k_proj
Quantizing ...
time 0.52
error 38234352.0
9 self_attn.v_proj
Quantizing ...
time 0.52
error 38013972.0
9 self_attn.o_proj
Quantizing ...
time 0.52
error 1989031.125
9 mlp.gate_proj
Quantizing ...
time 0.53
error 42969748.0
9 mlp.up_proj
Quantizing ...
time 0.52
error 42900744.0
9 mlp.down_proj
Quantizing ...
time 1.67

 31%|██████████████████████████████████████████████████████████▊                                                                                                                                 | 10/32 [02:30<05:35, 15.24s/it]
10 self_attn.q_proj
Quantizing ...
time 0.99
error 39733848.0
10 self_attn.k_proj
Quantizing ...
time 0.52
error 39813384.0
10 self_attn.v_proj
Quantizing ...
time 0.52
error 39508984.0
10 self_attn.o_proj
Quantizing ...
time 0.52
error 2820096.5
10 mlp.gate_proj
Quantizing ...
time 0.53
error 45115996.0
10 mlp.up_proj
Quantizing ...
time 0.52
error 45000832.0
10 mlp.down_proj
Quantizing ...
time 1.65

 34%|████████████████████████████████████████████████████████████████▋                                                                                                                           | 11/32 [02:45<05:20, 15.25s/it]
11 self_attn.q_proj
Quantizing ...
time 1.01
error 48772140.0
11 self_attn.k_proj
Quantizing ...
time 0.52
error 48791532.0
11 self_attn.v_proj
Quantizing ...
time 0.52
error 48522320.0
11 self_attn.o_proj
Quantizing ...
time 0.52
error 2768618.25
11 mlp.gate_proj
Quantizing ...
time 0.53
error 49210592.0
11 mlp.up_proj
Quantizing ...
time 0.53
error 49084188.0
11 mlp.down_proj
Quantizing ...
time 1.67

 38%|██████████████████████████████████████████████████████████████████████▌                                                                                                                     | 12/32 [03:01<05:05, 15.28s/it]
12 self_attn.q_proj
Quantizing ...
time 1.00
error 49393360.0
12 self_attn.k_proj
Quantizing ...
time 0.52
error 49461872.0
12 self_attn.v_proj
Quantizing ...
time 0.52
error 49248796.0
12 self_attn.o_proj
Quantizing ...
time 0.52
error 3230632.25
12 mlp.gate_proj
Quantizing ...
time 0.52
error 52918384.0
12 mlp.up_proj
Quantizing ...
time 0.52
error 52850820.0
12 mlp.down_proj
Quantizing ...
time 1.66

 41%|████████████████████████████████████████████████████████████████████████████▍                                                                                                               | 13/32 [03:16<04:50, 15.29s/it]
13 self_attn.q_proj
Quantizing ...
time 1.04
error 51564440.0
13 self_attn.k_proj
Quantizing ...
time 0.52
error 51618112.0
13 self_attn.v_proj
Quantizing ...
time 0.52
error 51315472.0
13 self_attn.o_proj
Quantizing ...
time 0.52
error 3357293.5
13 mlp.gate_proj
Quantizing ...
time 0.53
error 56066416.0
13 mlp.up_proj
Quantizing ...
time 0.53
error 55979992.0
13 mlp.down_proj
Quantizing ...
time 1.65

 44%|██████████████████████████████████████████████████████████████████████████████████▎                                                                                                         | 14/32 [03:31<04:35, 15.30s/it]
14 self_attn.q_proj
Quantizing ...
time 1.00
error 53450088.0
14 self_attn.k_proj
Quantizing ...
time 0.52
error 53519156.0
14 self_attn.v_proj
Quantizing ...
time 0.52
error 53166724.0
14 self_attn.o_proj
Quantizing ...
time 0.52
error 4156879.0
14 mlp.gate_proj
Quantizing ...
time 0.53
error 61988656.0
14 mlp.up_proj
Quantizing ...
time 0.52
error 61876792.0
14 mlp.down_proj
Quantizing ...
time 1.65

 47%|████████████████████████████████████████████████████████████████████████████████████████▏                                                                                                   | 15/32 [03:46<04:19, 15.29s/it]
15 self_attn.q_proj
Quantizing ...
time 0.99
error 52016464.0
15 self_attn.k_proj
Quantizing ...
time 0.52
error 52152280.0
15 self_attn.v_proj
Quantizing ...
time 0.52
error 51812312.0
15 self_attn.o_proj
Quantizing ...
time 0.53
error 4268355.5
15 mlp.gate_proj
Quantizing ...
time 0.53
error 66717212.0
15 mlp.up_proj
Quantizing ...
time 0.53
error 66551692.0
15 mlp.down_proj
Quantizing ...
time 1.65

 50%|██████████████████████████████████████████████████████████████████████████████████████████████                                                                                              | 16/32 [04:02<04:04, 15.30s/it]
16 self_attn.q_proj
Quantizing ...
time 1.00
error 54569168.0
16 self_attn.k_proj
Quantizing ...
time 0.52
error 54662060.0
16 self_attn.v_proj
Quantizing ...
time 0.52
error 54263800.0
16 self_attn.o_proj
Quantizing ...
time 0.52
error 5136847.0
16 mlp.gate_proj
Quantizing ...
time 0.53
error 74777768.0
16 mlp.up_proj
Quantizing ...
time 0.53
error 74625280.0
16 mlp.down_proj
Quantizing ...
time 1.65

 53%|███████████████████████████████████████████████████████████████████████████████████████████████████▉                                                                                        | 17/32 [04:17<03:49, 15.31s/it]
17 self_attn.q_proj
Quantizing ...
time 1.01
error 57405008.0
17 self_attn.k_proj
Quantizing ...
time 0.52
error 57474904.0
17 self_attn.v_proj
Quantizing ...
time 0.52
error 57201152.0
17 self_attn.o_proj
Quantizing ...
time 0.52
error 3842526.5
17 mlp.gate_proj
Quantizing ...
time 0.53
error 85378728.0
17 mlp.up_proj
Quantizing ...
time 0.53
error 85156160.0
17 mlp.down_proj
Quantizing ...
time 1.66

 56%|█████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                                                                  | 18/32 [04:32<03:34, 15.32s/it]
18 self_attn.q_proj
Quantizing ...
time 1.00
error 64896792.0
18 self_attn.k_proj
Quantizing ...
time 0.52
error 64919644.0
18 self_attn.v_proj
Quantizing ...
time 0.53
error 64580512.0
18 self_attn.o_proj
Quantizing ...
time 0.52
error 4109344.25
18 mlp.gate_proj
Quantizing ...
time 0.53
error 95673368.0
18 mlp.up_proj
Quantizing ...
time 0.52
error 95472768.0
18 mlp.down_proj
Quantizing ...
time 1.65

 59%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                                                                            | 19/32 [04:48<03:19, 15.32s/it]
19 self_attn.q_proj
Quantizing ...
time 0.99
error 64176736.0
19 self_attn.k_proj
Quantizing ...
time 0.52
error 64278184.0
19 self_attn.v_proj
Quantizing ...
time 0.52
error 63966860.0
19 self_attn.o_proj
Quantizing ...
time 0.52
error 3733530.0
19 mlp.gate_proj
Quantizing ...
time 0.53
error 102809744.0
19 mlp.up_proj
Quantizing ...
time 0.53
error 102723344.0
19 mlp.down_proj
Quantizing ...
time 1.65

 62%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                                                                      | 20/32 [05:03<03:03, 15.33s/it]
20 self_attn.q_proj
Quantizing ...
time 1.00
error 65114596.0
20 self_attn.k_proj
Quantizing ...
time 0.52
error 65158104.0
20 self_attn.v_proj
Quantizing ...
time 0.52
error 64745912.0
20 self_attn.o_proj
Quantizing ...
time 0.52
error 4014747.5
20 mlp.gate_proj
Quantizing ...
time 0.53
error 108216368.0
20 mlp.up_proj
Quantizing ...
time 0.52
error 108065896.0
20 mlp.down_proj
Quantizing ...
time 1.67

 66%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                                                                | 21/32 [05:19<02:48, 15.35s/it]
21 self_attn.q_proj
Quantizing ...
time 1.01
error 72094672.0
21 self_attn.k_proj
Quantizing ...
time 0.52
error 72131904.0
21 self_attn.v_proj
Quantizing ...
time 0.52
error 71791824.0
21 self_attn.o_proj
Quantizing ...
time 0.52
error 3775302.0
21 mlp.gate_proj
Quantizing ...
time 0.53
error 115440832.0
21 mlp.up_proj
Quantizing ...
time 0.53
error 115233280.0
21 mlp.down_proj
Quantizing ...
time 1.65

 69%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎                                                          | 22/32 [05:34<02:33, 15.35s/it]
22 self_attn.q_proj
Quantizing ...
time 1.00
error 74284064.0
22 self_attn.k_proj
Quantizing ...
time 0.52
error 74276552.0
22 self_attn.v_proj
Quantizing ...
time 0.52
error 73962736.0
22 self_attn.o_proj
Quantizing ...
time 0.52
error 4507964.0
22 mlp.gate_proj
Quantizing ...
time 0.53
error 121399992.0
22 mlp.up_proj
Quantizing ...
time 0.53
error 121301120.0
22 mlp.down_proj
Quantizing ...
time 1.66

 72%|███████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏                                                    | 23/32 [05:49<02:17, 15.33s/it]
23 self_attn.q_proj
Quantizing ...
time 1.01
error 82732336.0
23 self_attn.k_proj
Quantizing ...
time 0.52
error 82774208.0
23 self_attn.v_proj
Quantizing ...
time 0.52
error 82527552.0
23 self_attn.o_proj
Quantizing ...
time 0.53
error 4248465.0
23 mlp.gate_proj
Quantizing ...
time 0.53
error 129941920.0
23 mlp.up_proj
Quantizing ...
time 0.52
error 129770736.0
23 mlp.down_proj
Quantizing ...
time 1.65

 75%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████                                               | 24/32 [06:04<02:02, 15.32s/it]
24 self_attn.q_proj
Quantizing ...
time 0.99
error 81032816.0
24 self_attn.k_proj
Quantizing ...
time 0.52
error 81113984.0
24 self_attn.v_proj
Quantizing ...
time 0.52
error 80756288.0
24 self_attn.o_proj
Quantizing ...
time 0.52
error 4762566.5
24 mlp.gate_proj
Quantizing ...
time 0.53
error 136277088.0
24 mlp.up_proj
Quantizing ...
time 0.52
error 136195904.0
24 mlp.down_proj
Quantizing ...
time 1.66

 78%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉                                         | 25/32 [06:20<01:47, 15.32s/it]
25 self_attn.q_proj
Quantizing ...
time 0.99
error 93271152.0
25 self_attn.k_proj
Quantizing ...
time 0.52
error 93380624.0
25 self_attn.v_proj
Quantizing ...
time 0.52
error 93051784.0
25 self_attn.o_proj
Quantizing ...
time 0.52
error 3545542.5
25 mlp.gate_proj
Quantizing ...
time 0.53
error 145631056.0
25 mlp.up_proj
Quantizing ...
time 0.52
error 145463744.0
25 mlp.down_proj
Quantizing ...
time 1.65

 81%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊                                   | 26/32 [06:35<01:31, 15.30s/it]
26 self_attn.q_proj
Quantizing ...
time 1.00
error 89507400.0
26 self_attn.k_proj
Quantizing ...
time 0.52
error 89615000.0
26 self_attn.v_proj
Quantizing ...
time 0.52
error 89282184.0
26 self_attn.o_proj
Quantizing ...
time 0.52
error 5434050.0
26 mlp.gate_proj
Quantizing ...
time 0.53
error 152677712.0
26 mlp.up_proj
Quantizing ...
time 0.52
error 152524256.0
26 mlp.down_proj
Quantizing ...
time 1.65

 84%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▋                             | 27/32 [06:50<01:16, 15.29s/it]
27 self_attn.q_proj
Quantizing ...
time 0.99
error 91593200.0
27 self_attn.k_proj
Quantizing ...
time 0.52
error 91564824.0
27 self_attn.v_proj
Quantizing ...
time 0.52
error 91357440.0
27 self_attn.o_proj
Quantizing ...
time 0.52
error 4840600.5
27 mlp.gate_proj
Quantizing ...
time 0.53
error 161587264.0
27 mlp.up_proj
Quantizing ...
time 0.53
error 161451632.0
27 mlp.down_proj
Quantizing ...
time 1.64

 88%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▌                       | 28/32 [07:05<01:01, 15.27s/it]
28 self_attn.q_proj
Quantizing ...
time 1.00
error 94538544.0
28 self_attn.k_proj
Quantizing ...
time 0.52
error 94515344.0
28 self_attn.v_proj
Quantizing ...
time 0.52
error 94242496.0
28 self_attn.o_proj
Quantizing ...
time 0.52
error 5383300.0
28 mlp.gate_proj
Quantizing ...
time 0.53
error 168606464.0
28 mlp.up_proj
Quantizing ...
time 0.53
error 168654768.0
28 mlp.down_proj
Quantizing ...
time 1.65

 91%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▍                 | 29/32 [07:21<00:45, 15.27s/it]
29 self_attn.q_proj
Quantizing ...
time 0.99
error 87379552.0
29 self_attn.k_proj
Quantizing ...
time 0.52
error 87548320.0
29 self_attn.v_proj
Quantizing ...
time 0.52
error 87177056.0
29 self_attn.o_proj
Quantizing ...
time 0.52
error 5108160.5
29 mlp.gate_proj
Quantizing ...
time 0.53
error 172957504.0
29 mlp.up_proj
Quantizing ...
time 0.52
error 172905024.0
29 mlp.down_proj
Quantizing ...
time 1.65

 94%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▎           | 30/32 [07:36<00:30, 15.25s/it]
30 self_attn.q_proj
Quantizing ...
time 0.99
error 91668384.0
30 self_attn.k_proj
Quantizing ...
time 0.52
error 91694528.0
30 self_attn.v_proj
Quantizing ...
time 0.52
error 91437800.0
30 self_attn.o_proj
Quantizing ...
time 0.52
error 5794763.0
30 mlp.gate_proj
Quantizing ...
time 0.53
error 169219136.0
30 mlp.up_proj
Quantizing ...
time 0.52
error 169339616.0
30 mlp.down_proj
Quantizing ...
time 1.65

 97%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏     | 31/32 [07:51<00:15, 15.25s/it]
31 self_attn.q_proj
Quantizing ...
time 1.00
error 60334832.0
31 self_attn.k_proj
Quantizing ...
time 0.52
error 60385336.0
31 self_attn.v_proj
Quantizing ...
time 0.52
error 60172632.0
31 self_attn.o_proj
Quantizing ...
time 0.52
error 7848322.0
31 mlp.gate_proj
Quantizing ...
time 0.53
error 131384944.0
31 mlp.up_proj
Quantizing ...
time 0.53
error 131414448.0
31 mlp.down_proj
Quantizing ...
time 1.66
error 125748448.0

100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 32/32 [08:06<00:00, 15.22s/it]
wikitext2
Evaluating ...
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
5.507449626922607